{"version":3,"sources":["components/Defaults.js","components/functions.js","components/Platz.js","components/DayPicker.js","components/Belegungstag.js","components/BelForm.js","components/Belegung.js","components/Routing.js","components/App.js","index.js"],"names":["config","testuser","id","vorname","nachname","permissions","stringSeparator","smartphoneWidth","anzahlPlaetze","platzArray","daypickerMaxDays","daypickerDaysBeforeToday","daypickerDaysBeforeTodayWide","buchungenlog","platzbuchungen","dailyStartTime","dailyEndTime","eveningTime","maxMinutesDistance","singleTime","doubleTime","turnierTime","gastId","mitgliedId","gastJugId","mitgliedJugId","platzLeer","platzBelegt","slotMinimalMinutes","delimiter","hostname","protokoll","loginPage","prod","IMPORTANT","messages","gast","mitglied","veranstaltung","spieleranzahl","jugendvorrecht","erwachsenenvorrecht","einzeldauer","doppeldauer","turnier","turnierspieldauer","zeit","platzbelegt","i","push","formatDate","d","month","getMonth","day","getDate","year","getFullYear","length","join","spielerzusatz","geburtsdatum","schnupper","aktuellesJahr","Date","geburtsjahr","zusatz","Number","replace","parseCookie","str","split","map","v","reduce","acc","decodeURIComponent","trim","getTimetable","belegungen","endeTag","setHours","timetable","getTime","Config","tagesZeit","toTimeString","substr","bKey","sa","starts_at","anzahlSlots","ends_at","saTmp","cTmp","court","Platz","props","handleWindowSizeChange","setState","zumBelegungstag","state","courtData","isLoading","error","width","window","innerWidth","prevProps","this","fetchPlatz","uPermissions","userIsAllowed","url","addEventListener","fetch","credentials","then","result","ok","redirected","location","href","json","records","r","spieler","k","cn","computeBelClasses","booking_type","formatSpieler","platzWide","match","key","className","substring","comment","Link","to","pathname","c","op","removeEventListener","Component","p1vn","p1nn","p1geb","schnupper1","p2vn","p2nn","p2geb","schnupper2","p3vn","p3nn","p3geb","schnupper3","p4vn","p4nn","p4geb","schnupper4","s","RegExp","e","bookingType","dauer","bt","classNames","list","MenuItem","text","selected","Arrow","ArrowLeft","ArrowRight","DayPicker","onSelect","onClickHandler","startswith","end","setDate","start","dt","arr","name","toLocaleDateString","weekday","getDateArray","menu","el","data","arrowLeft","arrowRight","Belegungstag","dayDate","params","isNaN","setDay","bind","dString","firstDaypickerDay","courtDiv","src","alt","Zeitleiste","m","toString","padStart","index","Fragment","Legende","BelForm","handleChange","handleSave","handleDelete","sd","st","scd","ssd","servertime","document","cookie","servertimeNow","dateIsToday","valueOf","deleteActive","user_id","p1id","p2id","p3id","p4id","includes","userId","Permissions","ed","et","sdA","spieltag","startsAtDate","endsAtDate","startsAt","endsAt","p1","p2","p3","p4","belegungenAbJetzt","zurTafel","saveActive","endeActive","admin","overbooked","jugend","nichtVollBerechtigte","isLoading1","isLoading2","courtBelegt","Error","catch","Redirect","condMF","onChange","value","disabled","startsAtMsgClass","startsAtMsgTxt","Object","keys","ttl","p1MsgClass","p1MsgTxt","p1MsgFormCtrl","commentMsgClass","commentMsgTxt","type","placeholder","onClick","preventDefault","parameters","rc","returncode","logurl","Messages","sdStr","jetzt","target","endsAtViertel","endsAtStd","toLocaleString","minimumIntegerDigits","useGrouping","condEinGast","condEinMitglied","condEinSpielerErwVoll","condDoppelteSpieler","condUserIstSpieler","datestring","hd","Holidays","init","condSonnOderFeiertag","isHoliday","getDay","ende","pKeys","forEach","p","pAttr","find","o","isJugendlicher","saveActiveMerker","p1msgClass","_","uniq","dToday","getHours","getMinutes","Belegung","belegung","updateBel","newBel","console","log","getEmptyBel","Routing","Switch","Route","exact","path","render","App","user","isLoggedIn","renderData","checkUser","setPermission","res","retcode","ReactDOM","getElementById"],"mappings":"ySAKMA,EAAS,CACbC,SAAU,CAACC,GAAG,IAAKC,QAAQ,OAAQC,SAAS,gBAAiBC,YAAa,OAG1EC,gBAAiB,IACjBC,gBAAiB,IACjBC,cAAe,EACfC,WAAY,GACZC,iBAAkB,IAClBC,yBAA0B,EAC1BC,6BAA8B,EAC9BC,aAAc,+BACdC,eAAgB,wBAEhBC,eAAgB,EAChBC,aAAc,GACdC,YAAa,KACbC,mBAAoB,GACpBC,WAAY,GACZC,WAAY,IACZC,YAAa,IACbC,OAAQ,EACRC,WAAY,GACZC,UAAW,GACXC,cAAe,GACfC,UAAW,WACXC,YAAa,SACbC,mBAAoB,KACpBC,UAAW,eACXC,SAAU,GACVC,UAAW,GACXC,UAAW,GACXC,MAAM,GAINjC,EAAO8B,SAAW,YAClB9B,EAAO+B,UAAY,UACnB/B,EAAOgC,UAAY,oBACnBhC,EAAOiC,MAAO,EA2BhB,IAnBA,IAAMC,EAAY,cAKLC,EAAW,CACtBC,KAAM,CAACF,GAJM,EAIa,4GAC1BG,SAAU,CAACH,GALE,EAKiB,iGAC9BI,cAAe,CAACJ,GALL,EAKsB,8FACjCK,cAAe,CAACL,GAPH,EAOsB,oCACnCM,eAAgB,CATN,aAEC,EAOiB,qEAC5BC,oBAAqB,CAACP,GATT,EAS4B,yHACzCQ,YAAa,CAACR,GAVD,EAUoB,iDACjCS,YAAa,CAACT,GAXD,EAWoB,kDACjCU,QAAS,CAbC,aAEC,EAWU,uPACrBC,kBAAmB,CAACX,GAbP,EAa0B,uPACvCY,KAAM,CAACZ,GAdM,EAca,yCAC1Ba,YAAc,CAACb,GAfF,EAeqB,4BAE3Bc,EAAI,EAAGA,GAAKhD,EAAOQ,cAAewC,IACzChD,EAAOS,WAAWwC,KAAKD,GAIlB,IAAM3C,EAYY,GAZZA,EAeE,IAIAL,IC7FFkD,EAAa,SAACC,GACzB,IAAIC,EAAQ,IAAMD,EAAEE,WAAa,GAC/BC,EAAM,GAAKH,EAAEI,UACbC,EAAOL,EAAEM,cAKX,OAHIL,EAAMM,OAAS,IAAGN,EAAQ,IAAMA,GAChCE,EAAII,OAAS,IAAGJ,EAAM,IAAMA,GAEzB,CAACE,EAAMJ,EAAOE,GAAKK,KAAK,MAkBpBC,EAAgB,SAACC,EAAcC,GAC1C,IAAIC,EAAgB,IAAIC,KACxBD,EAAgBA,EAAcN,cAC9B,IAAIQ,EAAc,IAAID,KAAKH,GAIvBK,EAAS,MAFGH,GADhBE,EAAcA,EAAYR,eACqB,GAEjB,MAAQ,KAA6B,IAAtBU,OAAOL,GAAmB,QAAU,IAAM,IAGvF,OADAI,GADAA,EAASA,EAAOE,QAAQ,KAAM,MACdA,QAAQ,KAAM,KA2B1BC,EAAc,SAAAC,GAAG,OACrBA,EACGC,MAAM,KACNC,KAAI,SAAAC,GAAC,OAAIA,EAAEF,MAAM,QACjBG,QAAO,SAACC,EAAKF,GAEZ,OADAE,EAAIC,mBAAmBH,EAAE,GAAGI,SAAWD,mBAAmBH,EAAE,GAAGI,QACxDF,IACN,KAuCA,SAASG,EAAaC,GAK3B,IAAIjC,EAAO,IAAIkB,KACXgB,EAAU,IAAIhB,KAGlBlB,EAAKmC,SAAS,EAAG,EAAG,EAAG,GACvBD,EAAQC,SAAS,GAAI,EAAG,EAAG,GAE3B,IADA,IAAMC,EAAY,GACXpC,GAAQkC,EAASlC,EAAO,IAAIkB,KAAKlB,EAAKqC,UAAYC,EAAOxD,oBAAqB,CACnF,IAAMyD,EAAYvC,EAAKwC,eAAeC,OAAO,EAAG,GAChDL,EAAUG,GAAa,GACvB,IAAK,IAAIrC,EAAI,EAAGA,GAAKoC,EAAO5E,cAAewC,IACzCkC,EAAUG,GAAWpC,KAAKD,GAS9B,IAAK,IAAIwC,KAAQT,EAKf,IAJA,IAAIU,EAAK,IAAIzB,KAAKe,EAAWS,GAAME,WAG/BC,GAFK,IAAI3B,KAAKe,EAAWS,GAAMI,SAEXH,GAAML,EAAOxD,mBAC5BoB,EAAI,EAAGA,EAAI2C,EAAa3C,IAAK,CACpC,IAAI6C,EAAQ,IAAI7B,KAAKyB,EAAGN,UAAanC,EAAIoC,EAAOxD,oBAC5CkE,EAAO3B,OAAOY,EAAWS,GAAMO,OAAS,EAC5Cb,EAAUW,EAAMP,eAAeC,OAAO,EAAG,IAAIO,GAAQV,EAAOzD,YAIhE,OAAOuD,E,IC1IHc,E,kDACJ,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IA2ERC,uBAAyB,WAEvB,EAAKC,SAAS,CAAEC,iBAAiB,KA3EjC,EAAKC,MAAQ,CACXC,UAAW,GACXC,WAAY,EACZC,OAAQ,EACRC,MAAOC,OAAOC,WACdP,iBAAiB,GARF,E,sDAYnB,SAAmBQ,GACjB,GAAIC,KAAKZ,MAAM3C,MAAQsD,EAAUtD,IAAK,CACpC,MAAkCuD,KAAKZ,MAAhCF,EAAP,EAAOA,MAAOzC,EAAd,EAAcA,IAAKjD,EAAnB,EAAmBA,YACnBwG,KAAKC,WAAWf,EAAOzC,EAAKjD,M,+BAIhC,WACE,MAAoCwG,KAAKZ,MAAjCF,EAAR,EAAQA,MAAOzC,EAAf,EAAeA,IAAKjD,EAApB,EAAoBA,YACpBwG,KAAKC,WAAWf,EAAOzC,EAAKjD,K,wBAG9B,SAAW0F,EAAOzC,EAAKyD,GAAe,IAAD,OAC7BC,GAAkB3G,EAAiC0G,GAAgB,EACnEE,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,iCAAmCiE,EAAQ,OAASzC,EAAM,OAASA,EACpHoD,OAAOQ,iBAAiB,SAAUL,KAAKX,wBAEvCW,KAAKV,SAAS,CAACI,WAAY,IAC3BY,MAAMF,EAAK,CAACG,YAAa,gBACxBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GAKT,OAJID,EAAOE,aAETd,OAAOe,SAASC,KAAOJ,EAAOL,KAEzBK,EAAOK,OAGZ,EAAKxB,SAAS,CAACI,WAAY,OAGhCc,MAAM,SAAAC,GACL,IAAIhB,EAAYgB,EAAOM,QAAQpD,KAAM,SAAAqD,GACnC,IACIC,EADAC,EAAIF,EAAE3H,GAEN8H,EAAKC,EAAmBJ,EAAEnC,UAAWmC,EAAEjC,QAASiC,EAAEK,cAGtD,OAFAJ,EAAUK,EAAcN,EAAG,EAAK5B,MAAMmC,YAEhCpB,GAAkBa,EAAEK,aAAaG,MAAM,8EAGzC,yBAAKC,IAAKP,EAAGQ,UAAWP,GACtB,gCAASH,EAAEnC,UAAU8C,UAAU,GAAG,KADpC,IACmDV,EACjD,iCAAOD,EAAEY,QAAT,MAKF,kBAACC,EAAA,EAAD,CAAMJ,IAAKP,EAAGQ,UAAWP,EAAIW,GAAI,CAAEC,SAAU,yBAA0BvC,MAAO,CAACwC,EAAG9C,EAAO/C,EAAG6E,EAAE3H,GAAIiD,EAAGG,EAAKwF,GAAI,YAC5G,gCAASjB,EAAEnC,UAAU8C,UAAU,GAAG,KADpC,IACmDV,EACjD,iCAAOD,EAAEY,QAAT,SAKR,EAAKtC,SAAS,CAACG,UAAWA,IAC1B,EAAKH,SAAS,CAACI,WAAY,S,kCAI/B,WACEG,OAAOqC,oBAAoB,SAAUlC,KAAKX,0B,oBAQ5C,WACE,OAAOW,KAAKR,MAAMC,c,GAnFF0C,aAwFdb,EAAgB,SAACN,EAAGO,GAExB,IAAIN,EAAU,GAuBd,OAdAA,EAAQ,IAAMD,EAAEoB,KAAOpB,EAAEoB,KAAO,IAAMpB,EAAEqB,KAAQrB,EAAEqB,KAAQrB,EAAEqB,KAAO,IAAMtF,EAAciE,EAAEsB,MAAOtB,EAAEuB,YAClGtB,EAAQ,IAAMD,EAAEwB,KAAOxB,EAAEwB,KAAO,IAAMxB,EAAEyB,KAAQzB,EAAEyB,KAAQzB,EAAEyB,KAAO,IAAM1F,EAAciE,EAAE0B,MAAO1B,EAAE2B,YAClG1B,EAAQ,IAAMD,EAAE4B,KAAO5B,EAAE4B,KAAO,IAAM5B,EAAE6B,KAAQ7B,EAAE6B,KAAQ7B,EAAE6B,KAAO,IAAM9F,EAAciE,EAAE8B,MAAO9B,EAAE+B,YAClG9B,EAAQ,IAAMD,EAAEgC,KAAOhC,EAAEgC,KAAO,IAAMhC,EAAEiC,KAAQjC,EAAEiC,KAAQjC,EAAEiC,KAAO,IAAMlG,EAAciE,EAAEkC,MAAOlC,EAAEmC,YASlGlC,GAHAA,GAFAA,EAAUA,EAAQtD,KAAK,SAAAyF,GAAC,OAAIA,EAAE7F,QAAQ,IAAI8F,OAAO,aAAc,QAE7CvG,KAAK,OAGLS,QAAQ,IAAI8F,OAAO,YAAa,KAO9CjC,EAAoB,SAACgC,EAAGE,EAAGC,GAG/B,IAAMC,EAAoC,GAA3BlG,OAAOgG,EAAE3B,UAAU,GAAG,KAAUrE,OAAOgG,EAAE3B,UAAU,GAAG,MAAoC,GAA3BrE,OAAO8F,EAAEzB,UAAU,GAAG,KAAUrE,OAAO8F,EAAEzB,UAAU,GAAG,MAC9H8B,EAAKF,EAOX,OANSG,IACP,KAAOF,EACP,KACA,KAAOJ,EAAEzB,UAAU,GAAI,IAAIpE,QAAQ,IAAK,KACxCkG,IAKWtE,I,kBCtIXwE,EAAO,GAILC,EAAW,SAAC,GAAwB,IAAtBC,EAAqB,EAArBA,KAAMC,EAAe,EAAfA,SACxB,OACE,yBAAKpC,UAAS,kBAAaoC,EAAW,QAAU,KAC7CD,IAkBDE,EAAQ,SAAC,GAAyB,IAAvBF,EAAsB,EAAtBA,KAAsB,EAAhBnC,UACrB,OACE,yBAEEA,UAAU,uBACVmC,IAIAG,EAAYD,EAAM,CAAEF,KAAM,IAAKnC,UAAW,eAC1CuC,EAAaF,EAAM,CAAEF,KAAM,IAAKnC,UAAW,eAsClCwC,E,4MAnCb1E,MAAQ,CACNsE,SAAU,G,EAWZK,SAAW,SAAA1C,GACT,EAAKnC,SAAS,CAAEwE,SAAUrC,IAAO,kBAAM,EAAKrC,MAAMgF,eAAe3C,O,wDATnE,WACE,MAA0BzB,KAAKZ,MAAxBiF,EAAP,EAAOA,WAAY5H,EAAnB,EAAmBA,IACf6H,EAAM,IAAInH,KAAKV,GACnB6H,EAAIC,QAAQD,EAAI5H,UAAY6B,EAAO1E,kBACnC8J,EFvCwB,SAACa,EAAOF,GAGlC,IAFA,IAAIG,EAAK,IAAItH,KAAKqH,GAChBE,EAAM,GACDD,GAAMH,GACXI,EAAItI,KAAK,CAAEuI,KAAMtI,EAAWoI,GAAKZ,KAAMY,EAAGG,mBAAmB,QAAS,CAAEC,QAAS,QAAStI,MAAO,QAASE,IAAK,cAC/GgI,EAAGF,QAAQE,EAAG/H,UAAY,GAE5B,OAAOgI,EEgCEI,CAAaT,EAAYC,GAChCtE,KAAKV,SAAS,CAACwE,SAAUrH,M,oBAM3B,WACE,IAAQqH,EAAa9D,KAAKR,MAAlBsE,SAEFiB,EAAYpB,EA1CahG,KAAI,SAAAqH,GACrC,IAAQL,EAAeK,EAAfL,KAAMd,EAASmB,EAATnB,KAEd,OACE,kBAAC,EAAD,CACEA,KAAMA,EACNpC,IAAKkD,OAsCP,OACE,yBAAKjD,UAAU,OACb,kBAAC,IAAD,CACEuD,KAAMF,EACNG,UAAWlB,EACXmB,WAAYlB,EACZH,SAAUA,EACVK,SAAUnE,KAAKmE,gB,GA5BDhC,a,2BCjClBiD,E,kDAEJ,aAAe,IAAD,8BACZ,gBA0BF/F,uBAAyB,WACvB,EAAKC,SAAS,CAAEM,MAAOC,OAAOC,cA1B9B,EAAKN,MAAQ,CACXI,MAAOC,OAAOC,WACdrD,IAAK,GACL4I,QAAS,IALC,E,sDAQd,WACExF,OAAOQ,iBAAiB,SAAUL,KAAKX,wBACvC,IHCwB/C,EGDpB+I,EAAUrF,KAAKZ,MAAMoC,MAAM8D,OAAO7I,IAIpC4I,GHHsB/I,EGAL,IAAIa,KAAKkI,cHCVlI,OAASoI,MAAMjJ,GGErB,IAAIa,KAAKkI,GAFT,IAAIlI,KAIhB6C,KAAKV,SAAS,CAAE+F,QAASA,EAAS5I,IAAKJ,EAAWgJ,KAElDrF,KAAKwF,OAASxF,KAAKwF,OAAOC,KAAKzF,Q,kCAKjC,WACEH,OAAOqC,oBAAoB,SAAUlC,KAAKX,0B,oBAO5C,SAAOqG,GACL,IAAMpJ,EAAI,IAAIa,KAAKuI,GACnB1F,KAAKV,SAAS,CAAC+F,QAAS/I,EAAGG,IAAKJ,EAAWC,O,oBAG7C,WAAU,IAAD,OACCsD,EAAUI,KAAKR,MAAfI,MACJ+F,EAAoB,IAAIxI,KAM5B,GADkByC,GAASzG,EAAOO,gBACpB,CACZiM,EAAkBpB,QAAQoB,EAAkBjJ,UAAYvD,EAAOW,0BAC/D,IAAM8L,EAAWzM,EAAOS,WAAW+D,KAAK,SAACuB,GACvC,OACE,yBAAKuC,IAAKvC,EAAO7F,GAAI,QAAU6F,GAC7B,2BAAOwC,UAAU,SACf,+BACE,wBAAIA,UAAU,YACZ,wBAAIA,UAAU,iBAAgB,kBAAC,EAAD,OAC9B,wBAAIA,UAAU,SACZ,yBAAKA,UAAU,eACb,0BAAMA,UAAU,eAAexC,GAC/B,kBAAC2C,EAAA,EAAD,CAAMC,GAAI,CAACC,SAAU,yBAA0BvC,MAAO,CAACwC,EAAG9C,EAAO5C,EAAG,EAAKkD,MAAM/C,IAAKwF,GAAI,SAAU,yBAAMP,UAAU,4BAA4BmE,IAAI,iBAAiBC,IAAI,oBAEzK,6BACE,kBAAC,EAAD,CAAO5G,MAAOA,EAAOzC,IAAK,EAAK+C,MAAM/C,IAAKjD,YAAa,EAAK4F,MAAM5F,YAAa+H,WAAW,aAS1G,OACE,6BACE,kBAAC,EAAD,CAAW8C,WAAYsB,EAAmBlJ,IAAKuD,KAAKR,MAAM/C,IAAK2H,eAAgBpE,KAAKwF,SACpF,kBAAC,IAAD,KACGI,GAEH,kBAAC,EAAD,OAIJD,EAAkBpB,QAAQoB,EAAkBjJ,UAAYvD,EAAOY,8BAC/D,IAAM6L,EAAWzM,EAAOS,WAAW+D,KAAK,SAACuB,GACvC,OAAQ,wBAAIuC,IAAKvC,EAAO7F,GAAI,QAAU6F,EAAOwC,UAAU,SACrD,6BACE,yBAAKA,UAAU,eACb,0BAAMA,UAAU,8BAA8BxC,GAC9C,kBAAC2C,EAAA,EAAD,CAAMC,GAAI,CAACC,SAAU,yBAA0BvC,MAAO,CAACwC,EAAG9C,EAAO5C,EAAG,EAAKkD,MAAM/C,IAAKwF,GAAI,SAAU,yBAAMP,UAAU,4BAA4BmE,IAAI,iBAAiBC,IAAI,oBAEzK,6BACE,kBAAC,EAAD,CAAO5G,MAAOA,EAAOzC,IAAK,EAAK+C,MAAM/C,IAAKjD,YAAa,EAAK4F,MAAM5F,YAAa+H,WAAW,UAMlG,OACE,6BACE,kBAAC,EAAD,CAAW8C,WAAYsB,EAAmBlJ,IAAKuD,KAAKR,MAAM/C,IAAK2H,eAAgBpE,KAAKwF,SACpF,2BAAO9D,UAAU,SACf,+BACE,wBAAIA,UAAU,YACZ,wBAAIA,UAAU,iBAAgB,kBAAC,EAAD,MAA9B,KACCkE,KAIP,kBAAC,EAAD,W,GA1GiBzD,aAiHrB4D,EAAa,WAEjB,IADA,IAAI9J,EAAO,GACFmH,EAAIjK,EAAOe,eAAgBkJ,GAAKjK,EAAOgB,aAAciJ,IAC5D,IAAK,IAAI4C,EAAI,EAAGA,EAAI,GAAIA,GAAI,GAC1B/J,EAAKG,KAAMgH,EAAE6C,WAAWC,SAAS,EAAG,KAAO,IAAMF,EAAEC,WAAWC,SAAS,EAAG,MAG9E,OACE,yBAAKxE,UAAU,cAEXzF,EAAK0B,KAAI,SAAC2F,EAAG6C,GAAJ,OACP,kBAAC,IAAMC,SAAP,CAAgB3E,IAAK0E,GACnB,yBAAKzE,UAAU,UAAS,yBAAKA,UAAU,cAAc4B,IACrD,yBAAK5B,UAAU,kBACf,yBAAKA,UAAU,kBACf,yBAAKA,UAAU,wBAQrB2E,EAAU,WACd,OACE,yBAAK3E,UAAU,aACb,yBAAKA,UAAU,mCAAf,iBACA,yBAAKA,UAAU,8BAAf,WACA,yBAAKA,UAAU,oCAAf,iBACA,yBAAKA,UAAU,kCAAf,eACA,yBAAKA,UAAU,+BAAf,cAMS0D,I,4DCmaAkB,E,kDAzjBb,WAAYlH,GAAQ,IAAD,uBACjB,cAAMA,IACDmH,aAAe,EAAKA,aAAad,KAAlB,gBACpB,EAAKe,WAAa,EAAKA,WAAWf,KAAhB,gBAClB,EAAKgB,aAAe,EAAKA,aAAahB,KAAlB,gBAEpB,IAAQzE,EAAM5B,EAAN4B,EAER,EAAeA,EAAEnC,UAAUnB,MAAM,KAAjC,mBAAKgJ,EAAL,KAASC,EAAT,KACIC,EAAM,IAAIzJ,KAAKuJ,GACfG,EJoCqB,WAC3B,IACMC,EADUtJ,EAAYuJ,SAASC,QACX,WAE1B,OADW,IAAI7J,KAAKG,OAAOwJ,IIvCfG,GACVL,EAAIxI,SAAS,EAAG,EAAG,EAAG,GACtByI,EAAIzI,SAAS,EAAG,EAAG,EAAG,GAEtB,IAAM8I,EAAeN,EAAIO,YAAcN,EAAIM,UAGrC5D,EAAkC,KAAnBvC,EAAEK,aAAwB6F,EAAc,YAAc,aAAgBlG,EAAEK,aAEvF+F,EADgB,CAAC9J,OAAO,CAAC0D,EAAEqG,UAAW/J,OAAO,CAAC0D,EAAEsG,OAAQhK,OAAO,CAAC0D,EAAEuG,OAAQjK,OAAO,CAAC0D,EAAEwG,OAAQlK,OAAO,CAAC0D,EAAEyG,QAAQC,SAASpK,OAAO,EAAK8B,MAAMuI,UACxGC,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAEnG,EAAewH,EAAEjC,QAAQrB,MAAM,KAA/B,mBAAKmK,EAAL,KAASC,EAAT,KACIC,EAAMrB,EAAGhJ,MAAM,KAtBF,OAuBjB,EAAK8B,MAAQ,CACXwB,EAAGA,EACHgH,SAAUD,EAAI,GAAK,IAAMA,EAAI,GAAK,IAAMA,EAAI,GAC5CE,aAAcvB,EACdwB,WAAYL,EACZM,SAAUxB,EAAGhF,UAAU,EAAG,GAC1ByG,OAAQN,EAAGnG,UAAU,EAAG,GACxB4B,YAAaA,EACb3B,QAA+B,qBAAdZ,EAAEY,QAA2B,GAAKZ,EAAEY,QACrDyG,GAAgB,IAAXrH,EAAEsG,KAAahK,OAAO,EAAK8B,MAAMuI,QAAUrK,OAAO0D,EAAEsG,MACzDgB,GAAIhL,OAAO0D,EAAEuG,MACbgB,GAAIjL,OAAO0D,EAAEwG,MACbgB,GAAIlL,OAAO0D,EAAEyG,MACbxG,QAAS,GACTwH,kBAAmB,GACnBvJ,MAA2B,qBAAZ8B,EAAE9B,MAAyB,KAAO8B,EAAE9B,MACnDwJ,UAAU,EACVC,YAAY,EACZvB,aAAcA,EACdwB,YAAY,EACZC,OAAO,EACP3B,YAAaA,EACb4B,YAAY,EACZC,QAAQ,EACRC,sBAAsB,EACtB3K,UAAW,GACX4K,YAAY,EACZC,YAAY,EACZC,YAAa,IAnDE,E,qDAwDnB,WAAqB,IAAD,OAEd/I,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,0BAC/C+E,KAAKV,SAAS,CAAE2J,YAAY,IAC5B3I,MAAMF,EAAK,CAAEG,YAAa,gBACvBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GAET,OAAOD,EAAOK,OAEd,MAAM,IAAIsI,MAAM,yCAGnB5I,MAAK,SAAAC,GACJ,IAAIQ,EAAUR,EAAOM,QAErB,EAAKzB,SAAS,CAAE2B,QAASA,EAASgI,YAAY,OAE/CI,OAAM,SAAA1J,GAAK,OAAI,EAAKL,SAAS,CAAEK,QAAOsJ,YAAY,OAGrD7I,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,oCAC3C+E,KAAKV,SAAS,CAAE4J,YAAY,IAC5B5I,MAAMF,EAAK,CAAEG,YAAa,gBACvBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GAET,OAAOD,EAAOK,OAEd,MAAM,IAAIsI,MAAM,2CAGnB5I,MAAK,SAAAC,GAGJ,EAAKnB,SAAS,CAAEjB,UAAWJ,EAAawC,EAAOM,SAAUmI,YAAY,OAGtEG,OAAM,SAAA1J,GAAK,OAAI,EAAKL,SAAS,CAAEK,QAAOuJ,YAAY,S,oBAIvD,WAAU,IAAD,OACP,EAAmClJ,KAAKR,MAAhCyJ,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,WACpB,GAAID,GAAcC,EAChB,OAAO,yCAET,IAA4B,IAAxBlJ,KAAKR,MAAMkJ,SAEb,OAAO,kBAACY,EAAA,EAAD,CAAUxH,GAAI,CAAEC,SAAU,iBAAkBvC,MAAOQ,KAAKR,MAAMyI,gBAEvE,IAAMsB,EAAU3B,KAAoCA,EAAiC5H,KAAKZ,MAAM5F,aAChG,OACE,6BACE,yCAAewG,KAAKR,MAAMwI,UAC1B,0BAAMtG,UAAU,eACd,8BAAUA,UAAU,UAClB,6BAAK,iDACH1B,KAAKR,MAAM0H,aACX,uFAEF,4BAAQ7N,GAAG,cAAcqI,UAAU,eAAe8H,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM+D,aAC/F,4BAAQmG,UAAW1J,KAAKR,MAAM0H,YAAauC,MAAM,aAAjD,UACA,4BAAQC,UAAW1J,KAAKR,MAAM0H,YAAauC,MAAM,aAAjD,UACA,4BAAQA,MAAM,cAAd,WACA,4BAAQC,UAAWH,EAAQE,MAAM,oBAAjC,iBACA,4BAAQC,UAAWH,EAAQE,MAAM,eAAjC,YACA,4BAAQC,UAAWH,EAAQE,MAAM,kBAAjC,gBAEF,6BAAK,yCAAL,IAA4B,0BAAMpQ,GAAG,cAAcqI,UAAW1B,KAAKR,MAAMmK,kBAAmB3J,KAAKR,MAAMoK,iBACvG,yBAAKlI,UAAU,cACb,6BACE,4BAAQrI,GAAG,WAAWqI,UAAW,gBAAkB1B,KAAKR,MAAMmK,iBAAkBH,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM2I,UAE3H0B,OAAOC,KAAK9J,KAAKR,MAAMnB,WAAWV,KAAI,SAAAoM,GAEpC,OACE,4BAAQtI,IAAKsI,EAAKN,MAAOM,GACtBA,EADH,WAiBZ,6BAAK,0CACL,yBAAKrI,UAAU,cACb,4BAAQrI,GAAG,QAAQqI,UAAU,eAAe8H,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAMN,OACzF,4BAAQuK,MAAM,MAAd,MACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,KACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,KACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,KACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,KACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,KACA,4BAAQC,SAAU1J,KAAKR,MAAM2J,YAAY,GAAIM,MAAM,KAAnD,OAGJ,6BAAK,yCACL,yBAAK/H,UAAU,cACb,6BACE,4BAAQrI,GAAG,SAASqI,UAAW,gBAAkB1B,KAAKR,MAAMmK,iBAAkBH,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM4I,QAEzHyB,OAAOC,KAAK9J,KAAKR,MAAMnB,WAAWV,KAAI,SAAAoM,GACpC,OAEE,4BAAQtI,IAAKsI,EAAKN,MAAOM,GACtBA,EADH,WAgBZ,6BAAK,gCAAU/J,KAAKR,MAAM+D,YAAY/B,MAAM,0CAA6C,UAAY,oBAArG,IAAkI,0BAAMnI,GAAG,QAAQqI,UAAW1B,KAAKR,MAAMwK,YAAahK,KAAKR,MAAMyK,WACjM,yBAAKvI,UAAU,YACb,4BAAQrI,GAAG,KAAKqI,UAAW,gBAAkB1B,KAAKR,MAAM0K,cAAeV,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM6I,IACpH,4BAAQoB,MAAM,KAAd,0BACCzJ,KAAKR,MAAMyB,QAAQtD,KAAI,SAAAqD,GACtB,OACE,4BAAQS,IAAK,KAAOT,EAAE3H,GAAIoQ,MAAOzI,EAAE3H,IAAK2H,EAAEC,QAAUlE,EAAciE,EAAEhE,aAAcgE,EAAE/D,gBAIxF+C,KAAKR,MAAM+D,YAAY/B,MAAM,0CAC7B,4BAAQnI,GAAG,KAAKqI,UAAW,gBAAkB1B,KAAKR,MAAM0K,cAAeV,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM8I,IACpH,4BAAQmB,MAAM,KAAd,0BACCzJ,KAAKR,MAAMyB,QAAQtD,KAAI,SAAAqD,GACtB,OACE,4BAAQS,IAAK,KAAOT,EAAE3H,GAAIoQ,MAAOzI,EAAE3H,IAAK2H,EAAEC,QAAUlE,EAAciE,EAAEhE,aAAcgE,EAAE/D,gBAIxF,IAGN,yBAAKyE,UAAU,YACgB,cAA3B1B,KAAKR,MAAM+D,YACX,4BAAQlK,GAAG,KAAKqI,UAAW,gBAAkB1B,KAAKR,MAAM0K,cAAeV,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAM+I,IACpH,4BAAQkB,MAAM,KAAd,0BACCzJ,KAAKR,MAAMyB,QAAQtD,KAAI,SAAAqD,GACtB,OACE,4BAAQS,IAAK,KAAOT,EAAE3H,GAAIoQ,MAAOzI,EAAE3H,IAAK2H,EAAEC,QAAUlE,EAAciE,EAAEhE,aAAcgE,EAAE/D,gBAIxF,GAEyB,cAA3B+C,KAAKR,MAAM+D,YACX,4BAAQlK,GAAG,KAAKqI,UAAW,gBAAkB1B,KAAKR,MAAM0K,cAAeV,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAMgJ,IACpH,4BAAQiB,MAAM,KAAd,0BACCzJ,KAAKR,MAAMyB,QAAQtD,KAAI,SAAAqD,GACtB,OACE,4BAAQS,IAAK,KAAOT,EAAE3H,GAAIoQ,MAAOzI,EAAE3H,IAAK2H,EAAEC,QAAUlE,EAAciE,EAAEhE,aAAcgE,EAAE/D,gBAIxF,IAIN,6BAAK,6CAAL,IAAgC,0BAAM5D,GAAG,aAAaqI,UAAW1B,KAAKR,MAAM2K,iBAAkBnK,KAAKR,MAAM4K,gBACzG,yBAAK1I,UAAU,cACb,2BAAO2I,KAAK,OAAOhR,GAAG,UAAUqI,UAAW,sBAAwB1B,KAAKR,MAAM0K,cAAeV,SAAUxJ,KAAKuG,aAAckD,MAAOzJ,KAAKR,MAAMoC,QAAS0I,YAAY,kCAGnK,4BAAQD,KAAK,SAASE,QAAS,SAAAjH,GAAO,EAAKkD,WAAWlD,IAAM5B,UAAU,sBAAsBgI,UAAW1J,KAAKR,MAAMmJ,YAAlH,aACA,4BAAQ0B,KAAK,SAASE,QAAS,SAAAjH,GAAO,EAAKmD,aAAanD,IAAM5B,UAAU,sBAAsBgI,UAAW1J,KAAKR,MAAM4H,cAApH,mB,wBAOV,SAAW9D,GAAI,IAAD,OACZA,EAAEkH,iBAEF,IAAMpH,EAAI,CAEVA,eAAmB,GACnBA,iBAAqB,GACrBA,YAAe,EACfA,cAAkB,IAEdqH,EACF,cACYzK,KAAKR,MAAMwB,EAAE3H,GACvB,OAAS2G,KAAKR,MAAMyI,aAAe,IAAMjI,KAAKR,MAAM2I,SACpD,OAASnI,KAAKR,MAAM0I,WAAa,IAAMlI,KAAKR,MAAM4I,OAClD,QAAUpI,KAAKZ,MAAMuI,OACrB,OAAS3H,KAAKR,MAAM6I,GACpB,OAASrI,KAAKR,MAAM8I,GACpB,OAAStI,KAAKR,MAAM+I,GACpB,OAASvI,KAAKR,MAAMgJ,GACpB,MAAQxI,KAAKR,MAAMN,MACnB,MAAQc,KAAKR,MAAM+D,YACnB,QAAUvD,KAAKR,MAAMoC,QACrB,QAEAxB,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAChC,wBACAwP,EAEJnK,MAAMF,EAAK,CAAEG,YAAa,gBACvBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GACT,OAAOD,EAAOK,OAEd,MAAM,IAAIsI,MAAM,4CAA8C,EAAK5J,MAAMwB,EAAE3H,OAG9EmH,MAAK,SAAAC,GACJ,IAAIiK,EAAKjK,EAAOM,QAAQ,GAAG4J,WAC3B,GAAW,OAAPD,EAAa,CAEf,IAAIE,EACFrM,EAAOrD,UACLqD,EAAOtD,SACPsD,EAAOvE,aACPyQ,EACJnK,MAAMsK,EAAQ,CAAErK,YAAa,gBAC7B,EAAKjB,SAAS,CAAEoJ,UAAU,SACrB,GAAW,mBAAPgC,EAAyB,mBAEqBG,EAAS3O,YAF9B,GAEjCkH,EAAEuG,iBAF+B,KAEbvG,EAAEuF,WAFW,KAECvF,EAAEwG,eAFH,UAKlC/J,OAAOe,SAASC,KAAOtC,EAAOpD,UAGhC,EAAKmE,SAAS8D,Q,0BAIpB,SAAaE,GAAI,IAAD,OAERwH,EAAQ9K,KAAKR,MAAMyI,aAAe,IAAMjI,KAAKR,MAAM2I,SAAW,IAC9DzB,EAAK,IAAIvJ,KAAK2N,GACdC,EAAQ,IAAI5N,KAIlB,GAFAmG,EAAEkH,iBAEE9D,GAAMqE,GAAUnD,EAAuB5H,KAAKZ,MAAM5F,YAAc,CAClE,IAAIiR,EACF,aACYzK,KAAKR,MAAMwB,EAAE3H,GACvB,QAAU2G,KAAKZ,MAAMuI,OACrBvH,EACF7B,EAAOrD,UACLqD,EAAOtD,SACPsD,EAAOtE,eACPwQ,EACJnK,MAAMF,EAAK,CAAEG,YAAa,gBACvBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GAAI,CAEb,IAAIkK,EAASrM,EAAOrD,UAAYqD,EAAOtD,SACnCsD,EAAOvE,aACPyQ,EACJnK,MAAMsK,EAAQ,CAAErK,YAAa,gBAC7B,EAAKjB,SAAS,CAAEoJ,UAAU,aAIhC1I,KAAKV,SAAS,CAAEoJ,UAAU,IAE5BpF,EAAEkH,mB,0BAIJ,SAAalH,GAAI,IAAD,OACdA,EAAEkH,iBAEFxK,KAAKV,SAAL,eAAiBgE,EAAE0H,OAAO3R,GAAKiK,EAAE0H,OAAOvB,QAAS,WAC/C,IAAMrG,EAAI,CAGVA,SAAa,GACbA,WAAe,GACfA,eAAmB,GACnBA,iBAAqB,GACrBA,cAAkB,GAClBA,gBAAoB,GAEpBA,YAAe,EACfA,cAAiB,EACjBA,YAAe,EACfA,cAAkB,GAClBA,YAAe,GACfA,EAAE+E,SAAW,EAAK3I,MAAM2I,SAIxB/E,EAAE/E,UAAY,EAAKmB,MAAMnB,UAEzB+E,EAAE+F,YAAc/F,EAAE/E,UAAU+E,EAAE+E,UAAUxK,KAAI,SAAAqE,GAAC,OAAIA,IAAMzD,EAAOzD,eAG9D,IAAImQ,EAAgB,EAAKzL,MAAM2I,SAASxG,UAAU,EAAG,GACjDuJ,EAAY,EAAK1L,MAAM4I,OAAOzG,UAAU,EAAG,GAChB,cAA3B,EAAKnC,MAAM+D,YACb2H,GAAa5N,OAAO,EAAKkC,MAAM2I,SAASxG,UAAU,EAAG,IAAM,GAAGwJ,eAAe,QAAS,CAAEC,qBAAsB,EAAGC,aAAa,IAEvH,EAAK7L,MAAM+D,YAAY/B,MAAM,iBACpC0J,GAAa5N,OAAO,EAAKkC,MAAM2I,SAASxG,UAAU,EAAG,IAAM,GAAGwJ,eAAe,QAAS,CAAEC,qBAAsB,EAAGC,aAAa,IAEvH,EAAK7L,MAAM+D,YAAY/B,MAAM,oBAC9BoG,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAChE0R,GAAa5N,OAAO,EAAKkC,MAAM2I,SAASxG,UAAU,EAAG,IAAM,GAAGwJ,eAAe,QAAS,CAAEC,qBAAsB,EAAGC,aAAa,IAE9HJ,EAAgB,EAAKzL,MAAM4I,OAAOzG,UAAU,EAAG,IAGnDyB,EAAEgF,OAAS8C,EAAY,IAAMD,EAG7B,IAAIK,GAAc,EACdC,GAAkB,EAClBC,GAAwB,EACxBC,GAAsB,EACtBC,GAAqB,EAEnBC,EAAa,EAAKnM,MAAMyI,aAAe,IAAM,EAAKzI,MAAM2I,SAAW,IACnEzB,EAAK,IAAIvJ,KAAKwO,GACdC,EAAK,IAAIC,IACfD,EAAGE,KAAK,KAAM,MACd,IACMC,IADeH,EAAGI,UAAUtF,IAC6B,IAAhBA,EAAGuF,UAAoC,IAAhBvF,EAAGuF,SASnEzH,EAA6C,GAArClH,OAAO8F,EAAE+E,SAASxG,UAAU,EAAG,IAAWrE,OAAO8F,EAAE+E,SAASxG,UAAU,EAAG,IACnFuK,EAA0C,GAAnC5O,OAAO8F,EAAEgF,OAAOzG,UAAU,EAAG,IAAWrE,OAAO8F,EAAEgF,OAAOzG,UAAU,EAAG,IAE1EwK,EAAQ,CAAC7O,OAAO,EAAKkC,MAAM6I,IAAK/K,OAAO,EAAKkC,MAAM8I,IAAKhL,OAAO,EAAKkC,MAAM+I,IAAKjL,OAAO,EAAKkC,MAAMgJ,KAMhGvH,EAAU,EAAKzB,MAAMyB,QAC3BuK,GAAwB,EACxBW,EAAMC,SAAQ,SAACC,GAEb,GAAS,MAALA,GAAkB,GAALA,EACjB,CACMA,IAAM/O,OAAO,EAAK8B,MAAMuI,UAC1B+D,GAAqB,GACjBW,IAAM9N,EAAO9D,QAAU4R,IAAM9N,EAAO5D,YACxC2Q,GAAc,GACVe,IAAM9N,EAAO7D,aACjB6Q,GAAkB,GAGpB,IAAIe,EAAQrL,EAAQsL,MAAK,SAAAC,GAAC,OAAIA,EAAEnT,KAAOgT,EAAEpG,eJ/YvB,SAACjJ,GAC3B,GAA8B,qBAAlBA,GAAkD,OAAjBA,EAC3C,OAAO,EAET,IAAIE,EAAgB,IAAIC,KACxBD,EAAgBA,EAAcN,cAC9B,IAAIQ,EAAc,IAAID,KAAKH,GAI3B,OAFiBE,GADjBE,EAAcA,EAAYR,eACsB,IIwYlC6P,CAAeH,EAAK,eAA4C,MAAvBA,EAAK,YAClDd,GAAwB,OAK9BE,EAAqBA,GAAsB,EAAKtM,MAAMuI,SAAW,EAAKnI,MAAMwB,EAAEqG,QAE9E,IAAIqF,GAAmB,EAGvB,GAAI,EAAKlN,MAAM+D,YAAY/B,MAAM,6DAA8D,CAE7F,GAA8B,IAA1BlE,OAAO,EAAKkC,MAAM6I,IAAW,CAAC,IAAD,cACYwC,EAASnP,cADrB,GAC9B0H,EAAEuJ,WAD4B,KAChBvJ,EAAEuF,WADc,KACFvF,EAAE6G,SADA,KAE/B7G,EAAE8G,cAAgB,aAGpB9G,EAAEkF,GAAKlF,EAAEmF,GAAKnF,EAAEoF,GAAK,EAIvB,GAFAkE,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAE/C,EAAKnJ,MAAM+D,YAAY/B,MAAM,8BAA+B,CAE9D,GAA8B,IAA1BlE,OAAO,EAAKkC,MAAM6I,KAAuC,IAA1B/K,OAAO,EAAKkC,MAAM8I,IAAW,CAAC,IAAD,cACnBuC,EAASnP,cADU,GAC7D0H,EAAEuJ,WAD2D,KAC/CvJ,EAAEuF,WAD6C,KACjCvF,EAAE6G,SAD+B,KAE9D7G,EAAE8G,cAAgB,kBACb,GAAI5M,OAAO,EAAKkC,MAAM6I,MAAQ/K,OAAO,EAAKkC,MAAM8I,IAAK,CAE1DmD,GAAsB,EAFoC,kBAGfZ,EAASnP,cAHM,GAGzD0H,EAAEuJ,WAHuD,KAG3CvJ,EAAEuF,WAHyC,KAG7BvF,EAAE6G,SAH2B,KAI1D7G,EAAE8G,cAAgB,aAGpB9G,EAAEmF,GAAKnF,EAAEoF,GAAK,EAIhB,GAFAkE,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAEpB,cAA3B,EAAKnJ,MAAM+D,cAGbkI,EAAuBmB,IAAEC,KAAK,CAAC,EAAKrN,MAAM6I,GAAI,EAAK7I,MAAM8I,GAAI,EAAK9I,MAAM+I,GAAI,EAAK/I,MAAMgJ,KAAK3L,OAAS,GAEhGyO,IACCG,GAAkD,IAA1BnO,OAAO,EAAKkC,MAAM+I,KAAuC,IAA1BjL,OAAO,EAAKkC,MAAMgJ,MAAY,CAAC,IAAD,cAC5CqC,EAASnP,cADmC,GACtF0H,EAAE4G,WADoF,KACxE5G,EAAEuF,WADsE,KAC1DvF,EAAE6G,SADwD,KAEvF7G,EAAE8G,cAAgB,aAMxB,GAFAwC,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAE/C2C,GAAeC,EACjB,GAAI,EAAK/L,MAAM+D,YAAY/B,MAAM,8BAE/B,GAAI,EAAKhC,MAAMoC,QAAQ/E,OAAS,EAAG,CAAC,IAAD,EACoByO,EAAcT,EAAStP,KAAOsP,EAASrP,SAD3D,mBAChC4H,EAAE+G,gBAD8B,KACb/G,EAAEuF,WADW,KACCvF,EAAEgH,cADH,KAEjChH,EAAE8G,cAAgB,kBAGjB,CAAC,IAAD,cACwCW,EAASnP,cADjD,GACF0H,EAAE4G,WADA,KACY5G,EAAEuF,WADd,KAC0BvF,EAAE6G,SAD5B,KAEH7G,EAAE8G,cAAgB,aAGtB,GAA+B,qBAA3B,EAAK1K,MAAM+D,YAAoC,CAAC,IAAD,cACIsH,EAASpP,cADb,GAChD2H,EAAE+G,gBAD8C,KAC7B/G,EAAEuF,WAD2B,KACfvF,EAAEgH,cADa,KAKnD,GAFAsC,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAE/C,EAAKnJ,MAAM+D,YAAY/B,MAAM,6BAA8B,CAG7D,IAAMsL,EAAS,IAAI3P,KAKnB,GAAKqH,GADsB,GAFhBsI,EAAOC,WACPD,EAAOE,cAEWzO,EAAOlE,qBAAuBmR,IAA0BO,GAAwBG,EAAQ3N,EAAOnE,YAAc,IAAM,GAAK,CAAC,IAAD,cAC5FyQ,EAASjP,oBADmF,GAClJwH,EAAEuG,iBADgJ,KAC9HvG,EAAEuF,WAD4H,KAChHvF,EAAEwG,eAD8G,KAEnJxG,EAAE0F,YAAa,GAMnB,GAHA4D,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAG/CnE,GAAS0H,EAAM,CAAC,IAAD,cACsCrB,EAAS5O,KAD/C,GAChBmH,EAAEuG,iBADc,KACIvG,EAAEuF,WADN,KACkBvF,EAAEwG,eADpB,UAGd,GAA+B,cAA3B,EAAKpK,MAAM+D,aAClB,GAAK2I,EAAO1H,EAASjG,EAAOjE,WAAY,CAAC,IAAD,cACiBuQ,EAAShP,YAD1B,GACrCuH,EAAEuG,iBADmC,KACjBvG,EAAEuF,WADe,KACHvF,EAAEwG,eADC,WAIrC,GAA+B,cAA3B,EAAKpK,MAAM+D,aAClB,GAAK2I,EAAO1H,EAASjG,EAAOhE,WAAY,CAAC,IAAD,cACiBsQ,EAAS/O,YAD1B,GACrCsH,EAAEuG,iBADmC,KACjBvG,EAAEuF,WADe,KACHvF,EAAEwG,eADC,WAIrC,GAA+B,eAA3B,EAAKpK,MAAM+D,YAClB,GAAK2I,EAAO1H,IAAWjG,EAAO/D,aAAgBoN,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAAe,CAAC,IAAD,cAChEqR,EAAS7O,kBADuD,GACtHoH,EAAEuG,iBADoH,KAClGvG,EAAEuF,WADgG,KACpFvF,EAAEwG,eADkF,SAElH,CAAC,IAAD,cACkDiB,EAAS9O,QAD3D,GACJqH,EAAEuG,iBADE,KACgBvG,EAAEuF,WADlB,KAC8BvF,EAAEwG,eADhC,KAIT8C,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAG/C,EAAKnJ,MAAM+D,YAAY/B,MAAM,oBAC/B4B,EAAEuF,WAAcf,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAC5E4J,EAAEgE,aAAgBQ,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAC9E4J,EAAEwF,YAAa,GAEb,EAAKpJ,MAAM+D,YAAY/B,MAAM,+BAC/B4B,EAAEuF,WAAa+C,GAAuB9D,KAA0BA,EAAuB,EAAKxI,MAAM5F,aAClG4J,EAAEgE,aAAesE,GAAuB9D,KAA0BA,EAAuB,EAAKxI,MAAM5F,aACpG4J,EAAEwF,YAAa,GAEb,EAAKpJ,MAAM+D,YAAY/B,MAAM,gFAC/B4B,EAAEuF,WAAcf,KAAoCA,EAAiC,EAAKxI,MAAM5F,aAChG4J,EAAEwF,YAAa,GAEb,EAAKpJ,MAAM+D,YAAY/B,MAAM,gFAC/B4B,EAAEgE,aAAgBQ,KAAoCA,EAAiC,EAAKxI,MAAM5F,cAEpGkT,GAAyC,IAArBA,GAA6BtJ,EAAEuF,WAEnDvF,EAAEuF,WAAa+D,EAGf,EAAKpN,SAAS8D,U,GArjBEjB,aCwFP8K,O,kDAzFb,WAAY7N,GAAQ,IAAD,8BACjB,cAAMA,IAEDI,MAAQ,CACX0N,SAAW,GACXxN,WAAY,EACZC,OAAQ,GANO,E,sDASnB,WACE,IAAOsC,EAAMjC,KAAKZ,MAAMwB,SAASpB,MAA1ByC,GACP,GAAW,WAAPA,EAAiB,CACnB,MAAejC,KAAKZ,MAAMwB,SAASpB,MAA5BrD,EAAP,EAAOA,EAAGG,EAAV,EAAUA,EACV0D,KAAKmN,UAAUhR,EAAGG,QACb,GAAW,QAAP2F,EAAc,CACvB,MAAejC,KAAKZ,MAAMwB,SAASpB,MAA5BwC,EAAP,EAAOA,EAAG1F,EAAV,EAAUA,EACV0D,KAAKoN,OAAOpL,EAAG1F,M,uBAInB,SAAUjD,EAAIoD,GAAM,IAAD,OACX2D,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,kCAAoC5B,EAErF2G,KAAKV,SAAS,CAACI,WAAY,IAE3BY,MAAMF,EAAK,CAACG,YAAa,gBACxBC,MAAK,SAAAC,GACJ,GAAIA,EAAOC,GAKT,OAJID,EAAOE,aACT0M,QAAQC,IAAI,qDACZzN,OAAOe,SAASC,KAAOJ,EAAOL,KAEzBK,EAAOK,OAEd,MAAM,IAAIsI,MAAM,iDAGnB5I,MAAK,SAAAC,GACJ,IAAIyM,EAAWzM,EAAOM,QAAQpD,KAAK,SAAAqD,GACjC,OACE,yBAAKS,IAAKT,EAAE3H,GAAIqI,UAAU,OACtB,kBAACG,EAAA,EAAD,CAAMC,GAAI,CAAEC,SAAU,iBAAkBvC,MAAO,CAAClD,EAAGG,KAAQ,uBAAGiF,UAAU,qBAAb,cAC3D,kBAAC,EAAD,CAASV,EAAGA,EAAG2G,OAAQ,EAAKvI,MAAMuI,OAAQnO,YAAa,EAAK4F,MAAM5F,kBAI1E,EAAK8F,SAAS,CAAE4N,SAAUA,OAE3B7D,OAAM,SAAA1J,GAAK,OAAI,EAAKL,SAAS,CAAEK,QAAOD,WAAW,S,oBAGpD,SAAOR,EAAOzC,GAEZ,IAAIuE,EAiBR,SAAqB9B,EAAOzC,GAC1B,MAAO,CACLpD,GAAI,EACJgO,QAAS,EACTgB,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJtJ,MAAOA,EACPL,UAAWpC,EAAM,YACjBsC,QAAStC,EAAM,YACf4E,aAAc,GACdrE,aAAc,aACdsK,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,GAjCE8F,CAAYrO,EAAOzC,GACvByQ,EAAW,CACX,yBAAKzL,KAAM,EAAGC,UAAU,OACpB,kBAACG,EAAA,EAAD,CAAMC,GAAI,CAAEC,SAAU,iBAAkBvC,MAAO,CAAClD,EAAGG,KAAQ,uBAAGiF,UAAU,qBAAb,cAC3D,kBAAC,EAAD,CAASV,EAAGA,EAAG2G,OAAQ3H,KAAKZ,MAAMuI,OAAQnO,YAAawG,KAAKZ,MAAM5F,gBAG1EwG,KAAKV,SAAS,CAAE4N,SAAUA,M,oBAG5B,WACE,OACE,6BAAMlN,KAAKR,MAAM0N,c,GAnEA/K,aCaRqL,G,4JAXX,WAAU,IAAD,OACP,OACE,kBAACC,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAK,yBAAyBC,OAAQ,SAACzO,GAAD,OAAW,kBAAC,GAAD,iBAAcA,EAAd,CAAqBuI,OAAQ,EAAKvI,MAAMuI,OAAQnO,YAAa,EAAK4F,MAAM5F,kBACtI,kBAACkU,EAAA,EAAD,CAAOG,OAAQ,SAACzO,GAAD,OAAW,kBAAC,EAAD,iBAAkBA,EAAlB,CAAyBuI,OAAQ,EAAKvI,MAAMuI,OAAQnO,YAAa,EAAK4F,MAAM5F,uB,GAL1F2I,aCkGP2L,G,kDAjGb,WAAY1O,GAAQ,IAAD,8BACjB,cAAMA,IAEDI,MAAQ,CACXuO,KAAM,GACNC,YAAY,EACZxU,YAAa,EACbyU,WAAY,GACZhF,YAAY,EACZC,YAAY,GATG,E,qDAanB,WAEElJ,KAAKV,UAAS,iBAAO,CAAE2J,YAAY,EAAOC,YAAY,MAClD3K,EAAOnD,MAET4E,KAAKkO,YACLlO,KAAKmO,iBAKLnO,KAAKV,UAAS,iBAAO,CAACyO,KAAMxP,EAAOnF,SAAUI,YAAa+E,EAAOnF,SAASI,kB,uBAO9E,WACC,IAAD,OACQ4G,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,4BACjDqF,MAAMF,EAAK,CAACG,YAAa,gBACxBC,MAAM,SAAC4N,GACFA,EAAI1N,IACN0N,EAAItN,OACHN,MAAM,SAACuN,GACe,OAAjBA,EAAKM,QACP,EAAK/O,UAAS,iBAAO,CAACyO,KAAMA,EAAKA,KAAM9E,YAAY,MAGnDpJ,OAAOe,SAASC,KAAOtC,EAAOrD,UAAYqD,EAAOtD,SAAWsD,EAAOpD,kB,2BAO7E,WACC,IAAD,OACQiF,EAAM7B,EAAOrD,UAAYqD,EAAOtD,SAAW,kCAEjDqF,MAAMF,EAAK,CAACG,YAAa,gBACxBC,MAAM,SAAC4N,GACFA,EAAI1N,IACN0N,EAAItN,OACHN,MAAM,SAAChH,GAEN,EAAK8F,UAAS,iBAAO,CAAC9F,YAAaA,EAAY6U,QAASnF,YAAY,c,oBAM5E,WAEE,MAAmClJ,KAAKR,MAAhCyJ,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,WACpB,OAAI3K,EAAOnD,OAAS6N,GAAcC,GACzB,yCAGL,kBAAC,IAAM9C,SAAP,KACE,yBAAK1E,UAAU,aACb,yBAAKA,UAAU,OACb,yBAAKA,UAAU,iBACb,yBAAKmE,IAAI,4BAA4BC,IAAI,eAE3C,yBAAKpE,UAAU,OACb,0BAAMA,UAAU,uBAAsB,uBAAGb,KAAK,iBAAiBxH,GAAG,WAA5B,iBACtC,0BAAMqI,UAAU,oBAAmB,oCAAU1B,KAAKR,MAAMuO,KAAKzU,QAAU,IAAM0G,KAAKR,MAAMuO,KAAKxU,SAA1D,OAErC,yBAAKmI,UAAU,OACb,yBAAKA,UAAU,sBAAqB,0BAAMA,UAAU,QAAO,uBAAGb,KAAK,sBAAqB,yBAAKgF,IAAI,qBAAqBC,IAAI,iBAKhI,kBAAC,GAAD,CAAS6B,OAAU3H,KAAKR,MAAMuO,KAAK1U,GAAIG,YAAewG,KAAKR,MAAMhG,cACjE,4BAAQkI,UAAU,qBAAlB,oG,GA5FQS,aCElBmM,IAAST,OACP,kBAAC,IAAD,KACE,kBAAC,GAAD,OAED9G,SAASwH,eAAe,W","file":"static/js/main.5f9866c1.chunk.js","sourcesContent":["\r\n// ****** Konfigurationsdaten *******\r\n\r\nexport const hostLocal = true   // true = localhost zum Testen\r\n\r\nconst config = {\r\n  testuser: {id:211, vorname:'Hart', nachname:'VerdrahtetAdm', permissions: 65535}, // mit Adminrechten\r\n  // testuser: {id:211, vorname:'Hart', nachname:'VerdrahtetUsr', permissions: 0}, // mit normalen Benutzerrechten\r\n  //  testuser: {id:357, vorname:'Hart', nachname:'VerdrahtetUsr2', permissions: 432}, // mit normalen Benutzerrechten\r\n  stringSeparator: ' ',\r\n  smartphoneWidth: 578,\r\n  anzahlPlaetze: 6,\r\n  platzArray: [],\r\n  daypickerMaxDays: 180,\r\n  daypickerDaysBeforeToday: 3, \r\n  daypickerDaysBeforeTodayWide: 9, \r\n  buchungenlog: '/intern/api/buchungenlog.php',\r\n  platzbuchungen: '/intern/api/platz.php',\r\n\r\n  dailyStartTime: 8,\r\n  dailyEndTime: 20,\r\n  eveningTime: 1700,  // 17:00 Uhr, alte Platzordnung war 18:00 Uhr\r\n  maxMinutesDistance: 15, // Gäste und Jugendliche dürfen abends erst kurz vor der Spielzeit buchen\r\n  singleTime: 60, // = 1 Stunde\r\n  doubleTime: 120, // = 2 Stunden \r\n  turnierTime: 120, // = 2 Stunden \r\n  gastId: 1,\r\n  mitgliedId: 25,\r\n  gastJugId: 28,\r\n  mitgliedJugId: 29,\r\n  platzLeer: \"\\u00A0\\u00A0\",\r\n  platzBelegt: \"\\u29EB\",\r\n  slotMinimalMinutes: 1800000, // = 30 Minuten\r\n  delimiter: \"§§§\",\r\n  hostname: '',\r\n  protokoll: '',\r\n  loginPage: '',\r\n  prod: false\r\n\r\n}\r\nif (hostLocal) {\r\n  config.hostname = 'localhost'\r\n  config.protokoll = 'http://'\r\n  config.loginPage = '/intern/login.php'\r\n  config.prod = false\r\n} else {    \r\n  config.hostname = 'www.tcolching.de'\r\n  config.protokoll = 'https://'\r\n  config.loginPage = '/intern/login.php'\r\n  config.prod = true\r\n}\r\n\r\nconst IMPORTANT = \"text-danger\"\r\nconst MSG = \"text-info\"\r\nconst NOSAVE = false\r\nconst SAVE = true\r\n\r\nexport const messages = {\r\n  gast: [IMPORTANT, NOSAVE, '- Bitte den Gastnamen ins Kommentarfeld schreiben und die Gebühr innerhalb einer Woche überweisen!'],\r\n  mitglied: [IMPORTANT, NOSAVE, '- Bitte nur für Mitglieder ohne Email verwenden und den Namen ins Kommentarfeld schreiben!'],\r\n  veranstaltung: [IMPORTANT, SAVE, '- Bitte den Veranstaltungsanlass ins Kommentarfeld schreiben und den Vorstand informieren!'],\r\n  spieleranzahl: [IMPORTANT, NOSAVE, '- Bitte alle Personen eintragen!'],\r\n  jugendvorrecht: [MSG, SAVE, '- Achtung: Jugendliche haben auf Platz 6 zu dieser Zeit Vorrecht!'],\r\n  erwachsenenvorrecht: [IMPORTANT, NOSAVE, '- Buchung erst 15 Minuten vor Spielbeginn möglich, da werktags ab 17:00 Uhr ein erw. Vollmitglied mitspielen muss.'],\r\n  einzeldauer: [IMPORTANT, NOSAVE, '- Für ein Einzel maximal 60 Minuten buchen'],\r\n  doppeldauer: [IMPORTANT, NOSAVE, '- Für ein Doppel maximal 120 Minuten buchen'],\r\n  turnier: [MSG, SAVE, '- Turnierspiele 120 Minuten. Falls möglich auf Platz 1 buchen. Parallel sollte ein Platz auf der Anlage nicht durch Turniere oder Training belegt sein! Wer Mannschaftstraining hat, darf nur auf den Plätzen der Mannschaft Turnier spielen.'],\r\n  turnierspieldauer: [IMPORTANT, NOSAVE, '- Turnierspiele 120 Minuten. Falls möglich auf Platz 1 buchen. Parallel sollte ein Platz auf der Anlage nicht durch Turniere oder Training belegt sein! Wer Mannschaftstraining hat, darf nur auf den Plätzen der Mannschaft Turnier spielen.'],\r\n  zeit: [IMPORTANT, NOSAVE, '- Der Start muss vor dem Ende liegen!'],\r\n  platzbelegt:  [IMPORTANT, NOSAVE, '- Platz bereits belegt!'],\r\n};\r\nfor (let i = 1; i <= config.anzahlPlaetze; i++) {\r\n  config.platzArray.push(i);\r\n}\r\n\r\n// ******* Rechtevergabe **********\r\nexport const permissions = {\r\n  // Es gibt 16 Rechte. Übereinandergelegt\r\n  \r\n  // Recht:        1 2 3 4  5  6  7   8   9  10   11   12   13   14    15    16\r\n  // Dezimalwert:  1 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 \r\n  //\r\n  // Summen daraus sind kombinierte Rechte, z.B. \r\n  //                3 ist Recht 1 und Recht 2\r\n  //               15 ist Recht 1, 2, 3, 4 (1+2+4+8)\r\n  //              128 ist Recht 8\r\n  //              143 ist Recht 1,2,3,4,8\r\n    NONE : 0,\r\n    MANNSCHAFTSFUEHRER : 32,\r\n    WIRT : 64,\r\n    T_ALL_PERMISSIONS : 128,    // Turnierverantwortliche\r\n    VORSTAND : 496,             // kombiniert 16, 32, 64, 128, 256\r\n    ADMINISTRATOR : 65535,\r\n};\r\n\r\nexport default config;\r\n","import Config from './Defaults';\r\n\r\nexport const formatDate = (d) => {\r\n  var month = '' + (d.getMonth() + 1),\r\n    day = '' + d.getDate(),\r\n    year = d.getFullYear();\r\n\r\n  if (month.length < 2) month = '0' + month;\r\n  if (day.length < 2) day = '0' + day;\r\n\r\n  return [year, month, day].join('-');\r\n}\r\n\r\n// ***** date array \r\nexport const getDateArray = (start, end) => {\r\n  let dt = new Date(start),\r\n    arr = [];\r\n  while (dt <= end) {\r\n    arr.push({ name: formatDate(dt), text: dt.toLocaleDateString(\"de-DE\", { weekday: 'short', month: 'short', day: 'numeric' }) });\r\n    dt.setDate(dt.getDate() + 1);\r\n  }\r\n  return arr;\r\n}\r\n\r\nexport const isValidDate = (d) => {\r\n  return d instanceof Date && !isNaN(d);\r\n}\r\n\r\nexport const spielerzusatz = (geburtsdatum, schnupper) => {\r\n  let aktuellesJahr = new Date();\r\n  aktuellesJahr = aktuellesJahr.getFullYear();\r\n  let geburtsjahr = new Date(geburtsdatum);\r\n  geburtsjahr = geburtsjahr.getFullYear();\r\n  const jugend = (aktuellesJahr - geburtsjahr) < 18 ? true : false;\r\n  // console.log(`${geburtsdatum} ${geburtsjahr} ${aktuellesJahr} ${jugend}` );\r\n  let zusatz = ' (' + (jugend ? 'Jug' : '') + (Number(schnupper) === 1 ? ',Schn' : '') + ')'\r\n  zusatz = zusatz.replace('(,', '(')\r\n  zusatz = zusatz.replace('()', '')\r\n  return zusatz\r\n}\r\n\r\n// jugendlicher = nicht voll Berechtigt\r\nexport const jugendlicher = (geburtsdatum) => {\r\n  if (typeof (geburtsdatum) === 'undefined' || geburtsdatum === null) {\r\n    return false;\r\n  }\r\n  let aktuellesJahr = new Date();\r\n  aktuellesJahr = aktuellesJahr.getFullYear();\r\n  let geburtsjahr = new Date(geburtsdatum);\r\n  geburtsjahr = geburtsjahr.getFullYear();\r\n  const jugend = ((aktuellesJahr - geburtsjahr) < 18) ? true : false;\r\n  // console.log(`${geburtsdatum} ${geburtsjahr} ${aktuellesJahr} ${jugend}` );\r\n  return jugend;\r\n}\r\n\r\n// Serverzeit?\r\nexport const servertimeNow = () => {\r\n  const cookies = parseCookie(document.cookie)\r\n  const servertime = cookies['servertime']\r\n  const st = new Date(Number(servertime))\r\n  return st\r\n}\r\n\r\n//#Source https://bit.ly/2neWfJ2 \r\nconst parseCookie = str =>\r\n  str\r\n    .split(';')\r\n    .map(v => v.split('='))\r\n    .reduce((acc, v) => {\r\n      acc[decodeURIComponent(v[0].trim())] = decodeURIComponent(v[1].trim());\r\n      return acc;\r\n    }, {});\r\n\r\n\r\n// Setze alle Zeiten auf false, die nicht als Start verwendet werden dürfen\r\nexport function getBookableTimes(tt) {\r\n  // Zu welchem Slot kann auf einem Platz gestartet werden?\r\n  let startBooking = ['--', '--', '--', '--', '--', '--']\r\n  for (let slot in tt) {  // Iteration über die Indizes der Slots\r\n    for (let p in tt[slot]) { // Iteration über die Indizes (0 - 5) der Plätze je Viertelstunden\r\n      if (startBooking[p] === '--' && tt[slot][p] === Config.platzBelegt) {  // Wenn ein Platz an einer Stelle nicht buchbar ist, ist er \"..\"\r\n        startBooking[p] = slot.substr(19, 2) // Merke dir die Minuten des Slots. An Pos 19 sind die Minuten\r\n      }\r\n    }\r\n  }\r\n  // Alle Plätze nur zu möglichen Startzeiten erlauben, andere Zeiten sperren (\"--\")\r\n  // z. B. Wenn eine Buchung um xx:30 Uhr besteht, dann sind keine Buchungen zur vollen Stunde erlaubt, \r\n  // um nicht Lücken entstehen zu lassen\r\n  // *****************  DERZEIT INAKTIV!!! ******************\r\n  const timetable = []\r\n  for (let slot in tt) {  // Iteration über die Indizes der Viertelstunden (0..51)\r\n    timetable[slot] = []\r\n    for (let p in tt[slot]) { // Iteration über die Indizes (0 - 5) der Plätze je Viertelstunden\r\n      // console.log(\"p, tt[slot][p]: \", p, tt[slot][p])\r\n      if (startBooking[p] === '--') { // Auf diesem Platz p gibt es an diesem Tag noch keine Buchung\r\n        timetable[slot][p] = tt[slot][p]  // Platzziffer übernehmen\r\n      }\r\n      else {\r\n        if ((startBooking[p] === slot.substr(19, 2) || tt[slot][p] === Config.platzBelegt)) {  // Das ist eine gültige Zeit für einen Platz\r\n          timetable[slot][p] = tt[slot][p] // Platzziffer (oder eben Sperrzeichen) übernehmen\r\n        } else {\r\n          timetable[slot][p] = Config.platzLeer\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return timetable\r\n}\r\n\r\n// Liefere die Daten für einen HTML-SELECT mit belegten und freien Zeiten\r\nexport function getTimetable(belegungen) {\r\n  // Erzeuge alle Zeiten als Timestamps für den HTML-Select in einem zweidimensionalen Objekt\r\n  // mit Uhrzeiten im Slot-Takt (z. B. 30 oder 15 Minutene, je nach Config)\r\n  // in der Form {<uhrzeit> : {platz: <platz>, <aktiv|inaktiv>}}\r\n\r\n  let zeit = new Date();\r\n  let endeTag = new Date();\r\n\r\n  // Die Timetable erzeugen, alle Plätze und Zeiten \"frei\", also Anzeige der Platznummer\r\n  zeit.setHours(8, 0, 0, 0);\r\n  endeTag.setHours(21, 0, 0, 0);\r\n  const timetable = [];\r\n  for (; zeit <= endeTag; zeit = new Date(zeit.getTime() + Config.slotMinimalMinutes)) {\r\n    const tagesZeit = zeit.toTimeString().substr(0, 5)\r\n    timetable[tagesZeit] = [];\r\n    for (let i = 1; i <= Config.anzahlPlaetze; i++) {\r\n      timetable[tagesZeit].push(i);\r\n    }\r\n  }\r\n\r\n  // Jetzt belegte Zeiten mit \"X\" belegen\r\n  // Wir haben 2 Objekte: \r\n  // 1. Wir iterieren über die Belegungen, sortiert nach Anfangszeit und Platz. \r\n  // 2. timetable, auf das wir direkt über die Zeit zugreifen\r\n  // console.log(belegungen)\r\n  for (let bKey in belegungen) {\r\n    let sa = new Date(belegungen[bKey].starts_at);\r\n    let ea = new Date(belegungen[bKey].ends_at);\r\n    // console.log(belegungen[bKey].starts_at + \", \" + belegungen[bKey].ends_at)\r\n    let anzahlSlots = (ea - sa) / Config.slotMinimalMinutes;\r\n    for (let i = 0; i < anzahlSlots; i++) {\r\n      let saTmp = new Date(sa.getTime() + (i * Config.slotMinimalMinutes));\r\n      let cTmp = Number(belegungen[bKey].court) - 1;\r\n      timetable[saTmp.toTimeString().substr(0, 5)][cTmp] = Config.platzBelegt;\r\n      // console.log(saTmp, timetable[saTmp][cTmp], ', court: ', cTmp)\r\n    }\r\n  }\r\n  return timetable;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n///////////////////////// KANN DAS FUNKTIONIEREN??? //////////////////////\r\n// const Model = () => {\r\n//   let liste = {};\r\n//   registerListener(callback) {\r\n//     liste                               ;\r\n//   }\r\n//   unregisterListener(callback) {\r\n//     callback.setTafelDatum(this.tafelDatum)///////////////////////////////////\r\n//   }\r\n// }\r\n\r\n// Auswahl über Mausposition???\r\n// handleClick (e) {\r\n\r\n//   var offset = $(this).offset();\r\n//   var hoehe = $(this).height(); \r\n//   var relativeX = (e.pageX - offset.left);\r\n//   var relativeY = (e.pageY - offset.top);\r\n//   var halbeStdHoehe = (hoehe - 30)/13;     \r\n//   var std = relativeY/halbeStdHoehe;\r\n//   var minuten = Math.round((std - Math.floor(std))) * 30;\r\n//   std = Math.floor(std) + 7;\r\n\r\n//   alert(\"X: \" + relativeX + \"  Y: \" + relativeY + \" Zeit: \" + std + \":\" + minuten + \" h, Höhe: \" + hoehe);\r\n\r\n// };\r\n","import React, { Component } from 'react';\r\nimport classNames from 'classnames';\r\nimport { Link } from 'react-router-dom';\r\nimport { spielerzusatz } from './functions';\r\nimport Config, { permissions } from './Defaults';\r\n\r\n\r\n// Alle Belegungen an diesem Tag für einen Platz\r\n\r\nclass Platz extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    \r\n    this.state = { \r\n      courtData: [],\r\n      isLoading : false,\r\n      error : false,\r\n      width: window.innerWidth,\r\n      zumBelegungstag: false,\r\n    };\r\n  }\r\n  \r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.day !== prevProps.day) {\r\n      const {court, day, permissions} = this.props;\r\n      this.fetchPlatz(court, day, permissions);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { court, day, permissions } = this.props;\r\n    this.fetchPlatz(court, day, permissions);\r\n  }\r\n  \r\n  fetchPlatz(court, day, uPermissions) {\r\n    const userIsAllowed = ((permissions.MANNSCHAFTSFUEHRER & uPermissions) > 0);\r\n    const url = Config.protokoll + Config.hostname + \"/intern/api/platz.php?op=ra&p=\" + court + \"&ds=\" + day + \"&de=\" + day;\r\n    window.addEventListener('resize', this.handleWindowSizeChange);\r\n    \r\n    this.setState({isLoading : true});\r\n    fetch(url, {credentials: 'same-origin'})\r\n    .then(result => {\r\n      if (result.ok) {\r\n        if (result.redirected) {\r\n          // console.log(\"Platz.js/Checkuser: Authentifizierungsfehler\")\r\n          window.location.href = result.url\r\n        }\r\n        return result.json();\r\n        } else {\r\n          // In diesem Fall haben wir einen neuen, noch unbebuchten Tag\r\n          this.setState({isLoading : false});\r\n        }\r\n      })\r\n    .then (result => {\r\n      let courtData = result.records.map ( r => {\r\n        let k = r.id\r\n        let spieler\r\n        let cn = computeBelClasses (r.starts_at, r.ends_at, r.booking_type);\r\n        spieler = formatSpieler(r, this.props.platzWide)\r\n\r\n        if ( !userIsAllowed && (r.booking_type.match(/(ts-training)|(ts-punktspiele)|(ts-nichtreservierbar)|(ts-veranstaltung)/ig)))\r\n        {\r\n          return ( \r\n            <div key={k} className={cn}>\r\n              <strong>{r.starts_at.substring(11,16)}</strong> {spieler} \r\n              <div> {r.comment} </div>\r\n            </div>\r\n          )\r\n        } else {\r\n          return ( \r\n            <Link key={k} className={cn} to={{ pathname: '/intern/tafel/belegung', state: {c: court, i: r.id, d: day, op: 'update'} }}>\r\n              <strong>{r.starts_at.substring(11,16)}</strong> {spieler}\r\n              <div> {r.comment} </div>\r\n            </Link>\r\n          )\r\n        }\r\n      })\r\n      this.setState({courtData: courtData});\r\n      this.setState({isLoading : false});\r\n    })\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.handleWindowSizeChange);\r\n  }\r\n\r\n  handleWindowSizeChange = () => {\r\n    // this.setState({ width: window.innerWidth });\r\n    this.setState({ zumBelegungstag: true });\r\n  };\r\n  \r\n  render() {\r\n    return this.state.courtData;\r\n  }\r\n}\r\n\r\n// Spielernamen bilden\r\nconst formatSpieler = (r, platzWide) =>\r\n{\r\n  let spieler = []\r\n  \r\n  // Vorname und Name verketten. Vorname bei wenig Platz abkürzen\r\n  // spieler[0] = (r.p1vn ? (platzWide ? r.p1vn : r.p1vn.charAt(0) + '.') + ' ' + r.p1nn : (r.p1nn) ? r.p1nn : '') + spielerzusatz(r.p1geb, r.schnupper1)\r\n  // spieler[1] = (r.p2vn ? (platzWide ? r.p2vn : r.p2vn.charAt(0) + '.') + ' ' + r.p2nn : (r.p2nn) ? r.p2nn : '') + spielerzusatz(r.p2geb, r.schnupper2)\r\n  // spieler[2] = (r.p3vn ? (platzWide ? r.p3vn : r.p3vn.charAt(0) + '.') + ' ' + r.p3nn : (r.p3nn) ? r.p3nn : '') + spielerzusatz(r.p3geb, r.schnupper3)\r\n  // spieler[3] = (r.p4vn ? (platzWide ? r.p4vn : r.p4vn.charAt(0) + '.') + ' ' + r.p4nn : (r.p4nn) ? r.p4nn : '') + spielerzusatz(r.p4geb, r.schnupper4)\r\n  \r\n  // Vorname und Name verketten. Vorname bei wenig Platz abkürzen\r\n  spieler[0] = (r.p1vn ? r.p1vn + ' ' + r.p1nn : (r.p1nn) ? r.p1nn : '') + spielerzusatz(r.p1geb, r.schnupper1)\r\n  spieler[1] = (r.p2vn ? r.p2vn + ' ' + r.p2nn : (r.p2nn) ? r.p2nn : '') + spielerzusatz(r.p2geb, r.schnupper2)\r\n  spieler[2] = (r.p3vn ? r.p3vn + ' ' + r.p3nn : (r.p3nn) ? r.p3nn : '') + spielerzusatz(r.p3geb, r.schnupper3)\r\n  spieler[3] = (r.p4vn ? r.p4vn + ' ' + r.p4nn : (r.p4nn) ? r.p4nn : '') + spielerzusatz(r.p4geb, r.schnupper4)\r\n  \r\n  // Führende Punkt und Whitespace entfernen, falls es sowas gibt\r\n  // eslint-disable-next-line\r\n  spieler = spieler.map( s => s.replace(new RegExp(/^[\\.\\s]+/g), '') )\r\n  \r\n  spieler = spieler.join(', ')\r\n\r\n  // ... und trailing Kommas, Whitespaces entfernen\r\n  spieler = spieler.replace(new RegExp(/[,\\s]*$/g), '')\r\n\r\n  return spieler\r\n\r\n}\r\n\r\n// CSS-Klassen bilden für die Positionierung und Höhe einer Belegung auf der Tafel\r\nconst computeBelClasses = (s, e, bookingType) =>\r\n{\r\n  // Dauer berechnen, also z. B. '2019-05-02 16:00:00' - '2019-05-02 14:00:00' = 120\r\n  const dauer = (Number(e.substring(11,13))*60 + Number(e.substring(14,16))) - (Number(s.substring(11,13))*60 + Number(s.substring(14,16)));\r\n  const bt = bookingType\r\n  let cn = classNames(\r\n    'D-' + dauer,\r\n    'ts', \r\n    'T-' + s.substring(11, 16).replace(':', '-'),\r\n    bt\r\n    );\r\n  return cn;\r\n}\r\n\r\nexport default Platz;\r\n","import React, { Component } from 'react';\r\nimport ScrollMenu from 'react-horizontal-scrolling-menu';\r\nimport {getDateArray} from \"./functions\";\r\nimport Config from './Defaults';\r\n\r\n\r\n// Das ist das Array mit den Tagen\r\nlet list = [];\r\n\r\n// One item component\r\n// selected prop will be passed\r\nconst MenuItem = ({ text, selected }) => {\r\n  return (\r\n    <div className={`dateBtn ${selected ? 'aktiv' : ''}`}>\r\n      {text}\r\n    </div>\r\n  );\r\n};\r\n\r\n// All items component\r\n// Important! add unique key\r\nexport const Menu = (list) => list.map(el => {\r\n  const { name, text } = el;\r\n\r\n  return (\r\n    <MenuItem\r\n      text={text}\r\n      key={name}\r\n    />\r\n  );\r\n});\r\n\r\nconst Arrow = ({ text, className }) => {\r\n  return (\r\n    <div\r\n      // className={className}\r\n      className=\"dateBtn arrowPicker\"\r\n    >{text}</div>\r\n  );\r\n};\r\n\r\nconst ArrowLeft = Arrow({ text: '<', className: 'arrow-prev' });\r\nconst ArrowRight = Arrow({ text: '>', className: 'arrow-next' });\r\n\r\nclass DayPicker extends Component {\r\n  state = {\r\n    selected: 0\r\n  };\r\n\r\n  componentWillMount() {\r\n    const {startswith, day} = this.props;\r\n    let end = new Date(day);\r\n    end.setDate(end.getDate() + Config.daypickerMaxDays);\r\n    list = getDateArray(startswith, end);\r\n    this.setState({selected: day});\r\n  }\r\n\r\n  onSelect = key => {\r\n    this.setState({ selected: key }, () => this.props.onClickHandler(key));\r\n  }\r\n  render() {\r\n    const { selected } = this.state;\r\n    // Create menu from items\r\n    const menu = Menu(list, selected);\r\n\r\n    return (\r\n      <div className=\"App\">\r\n        <ScrollMenu\r\n          data={menu}\r\n          arrowLeft={ArrowLeft}\r\n          arrowRight={ArrowRight}\r\n          selected={selected}\r\n          onSelect={this.onSelect}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default DayPicker;\r\n  \r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport Platz from \"./Platz\";\r\nimport DayPicker from \"./DayPicker\";\r\nimport \"./tafel.css\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport config from './Defaults';\r\nimport {formatDate, isValidDate} from \"./functions\";\r\nimport { Link } from 'react-router-dom';\r\n\r\n// Layout eines Tages\r\n\r\nclass Belegungstag extends Component {\r\n\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      width: window.innerWidth,\r\n      day: '',\r\n      dayDate: '',\r\n    };\r\n  }    \r\n  componentWillMount() {\r\n    window.addEventListener('resize', this.handleWindowSizeChange);\r\n    let dayDate = this.props.match.params.day;\r\n    if ( ! isValidDate(new Date(dayDate)) ) {\r\n      dayDate = new Date();\r\n    } else {\r\n      dayDate = new Date(dayDate);\r\n    }\r\n    this.setState({ dayDate: dayDate, day: formatDate(dayDate) });\r\n    // let day = \"2019-05-02\";\r\n    this.setDay = this.setDay.bind(this);\r\n  }\r\n\r\n  // make sure to remove the listener\r\n  // when the component is not mounted anymore\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.handleWindowSizeChange);\r\n  }\r\n\r\n  handleWindowSizeChange = () => {\r\n    this.setState({ width: window.innerWidth });\r\n  };\r\n\r\n  setDay(dString) {\r\n    const d = new Date(dString);\r\n    this.setState({dayDate: d, day: formatDate(d)});\r\n  }\r\n    \r\n  render() {\r\n    const { width } = this.state;\r\n    let firstDaypickerDay = new Date();\r\n\r\n    // //### TESTDATEN ###################\r\n    // firstDaypickerDay = new Date(2020, 4, 22);\r\n    \r\n    const isMobile = (width <= config.smartphoneWidth);\r\n    if (isMobile) {\r\n      firstDaypickerDay.setDate(firstDaypickerDay.getDate() - config.daypickerDaysBeforeToday);\r\n      const courtDiv = config.platzArray.map( (court) => {\r\n        return (\r\n          <div key={court} id={\"platz\" + court}>\r\n            <table className=\"table\">\r\n              <tbody>\r\n                <tr className=\"platzDim\">\r\n                  <td className=\"zeitleisteCol\"><Zeitleiste /></td>\r\n                  <td className=\"platz\">\r\n                    <div className=\"platznummer\">\r\n                      <span className=\"platzziffer\">{court}</span> \r\n                      <Link to={{pathname: '/intern/tafel/belegung', state: {c: court, d: this.state.day, op: 'new'} }}><img  className=\"neuBtn p-1 rounded-circle\" src=\"images/add.png\" alt=\"Neue Belegung\" /></Link> \r\n                    </div>\r\n                    <div>\r\n                      <Platz court={court} day={this.state.day} permissions={this.props.permissions} platzWide={true} />\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )\r\n      })\r\n      return (\r\n        <div>\r\n          <DayPicker startswith={firstDaypickerDay} day={this.state.day} onClickHandler={this.setDay} />\r\n          <SwipeableViews>\r\n            {courtDiv}\r\n          </SwipeableViews>\r\n          <Legende />\r\n        </div>\r\n      )\r\n    } else {\r\n      firstDaypickerDay.setDate(firstDaypickerDay.getDate() - config.daypickerDaysBeforeTodayWide);\r\n      const courtDiv = config.platzArray.map( (court) => {\r\n        return (<td key={court} id={\"platz\" + court} className=\"platz\">\r\n          <div>\r\n            <div className=\"platznummer\">\r\n              <span className=\"platzziffer rounded-circle\">{court}</span> \r\n              <Link to={{pathname: '/intern/tafel/belegung', state: {c: court, d: this.state.day, op: 'new'} }}><img  className=\"neuBtn p-1 rounded-circle\" src=\"images/add.png\" alt=\"Neue Belegung\" /></Link> \r\n            </div>\r\n            <div>            \r\n              <Platz court={court} day={this.state.day} permissions={this.props.permissions} platzWide={false} />\r\n              </div>\r\n            </div>\r\n          </td>\r\n        )\r\n      })\r\n      return (\r\n        <div>\r\n          <DayPicker startswith={firstDaypickerDay} day={this.state.day} onClickHandler={this.setDay} />\r\n          <table className=\"table\">\r\n            <tbody>\r\n              <tr className=\"platzDim\">\r\n                <td className=\"zeitleisteCol\"><Zeitleiste /> </td>\r\n                {courtDiv}\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <Legende />\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nconst Zeitleiste = () => {\r\n  let zeit = [];\r\n  for (let s = config.dailyStartTime; s <= config.dailyEndTime; s++) {\r\n    for (let m = 0; m < 60; m=m+60) {\r\n      zeit.push (s.toString().padStart(2, '0') + ':' + m.toString().padStart(2, '0'));\r\n    }\r\n  } \r\n  return (\r\n    <div className=\"zeitleiste\">\r\n      {\r\n        zeit.map((e, index) => \r\n          <React.Fragment key={index}>\r\n            <div className=\"stunde\"><div className=\"stundetext\">{e}</div></div>\r\n            <div className=\"viertelstunde\"></div>\r\n            <div className=\"viertelstunde\"></div>\r\n            <div className=\"viertelstunde\"></div>\r\n          </React.Fragment>\r\n        )\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nconst Legende = () => {\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row l-einzeldoppel p-0 pl-1 m-1\">Einzel/Doppel</div>\r\n      <div className=\"row l-turnier p-0 pl-1 m-1\">Turnier</div>\r\n      <div className=\"row l-veranstaltung p-0 pl-1 m-1\">Veranstaltung</div>\r\n      <div className=\"row l-punktspiele p-0 pl-1 m-1\">Punktspiele</div>\r\n      <div className=\"row l-training p-0 pl-1 m-1\">Training</div>\r\n      {/* <div className=\"row l-nichtreservierbar p-0 pl-1 m-1\">Frei verfügbar / Anderes</div> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Belegungstag;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","//\r\nimport React, { Component } from 'react';\r\nimport Config, { messages as Messages, permissions as Permissions } from './Defaults';\r\nimport { Redirect } from 'react-router';\r\nimport { spielerzusatz, servertimeNow, jugendlicher as isJugendlicher, getTimetable } from './functions';\r\nimport _ from 'lodash';\r\nimport Holidays from 'date-holidays';\r\n\r\nclass BelForm extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSave = this.handleSave.bind(this);\r\n    this.handleDelete = this.handleDelete.bind(this);\r\n\r\n    const { r } = props;\r\n    // Daten für Datum, Start und Ende extrahieren\r\n    let [sd, st] = r.starts_at.split(' ')\r\n    let scd = new Date(sd)\r\n    let ssd = servertimeNow()\r\n    scd.setHours(0, 0, 0, 0)\r\n    ssd.setHours(0, 0, 0, 0)\r\n\r\n    const dateIsToday = (scd.valueOf() === ssd.valueOf())\r\n\r\n    // Initialer Wert für neue Buchungen. Wenn Einzel/Doppel erlaubt/nicht erlaubt sind, hier ändern\r\n    const bookingType = (r.booking_type === '') ? (dateIsToday ? 'ts-einzel' : 'ts-turnier') : r.booking_type\r\n    const userDarfAlles = [Number([r.user_id]), Number([r.p1id]), Number([r.p2id]), Number([r.p3id]), Number([r.p4id])].includes(Number(this.props.userId))\r\n    const deleteActive = userDarfAlles || (Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))\r\n\r\n    let [ed, et] = r.ends_at.split(' ');\r\n    let sdA = sd.split('-');\r\n    this.state = {\r\n      r: r,\r\n      spieltag: sdA[2] + '.' + sdA[1] + '.' + sdA[0],\r\n      startsAtDate: sd,\r\n      endsAtDate: ed,\r\n      startsAt: st.substring(0, 5),\r\n      endsAt: et.substring(0, 5),\r\n      bookingType: bookingType,\r\n      comment: (typeof r.comment === \"undefined\") ? \"\" : r.comment,\r\n      p1: (r.p1id === 0 ? Number(this.props.userId) : Number(r.p1id)),\r\n      p2: Number(r.p2id),\r\n      p3: Number(r.p3id),\r\n      p4: Number(r.p4id),\r\n      spieler: [],\r\n      belegungenAbJetzt: [],\r\n      court: (typeof r.court === \"undefined\") ? \"--\" : r.court,\r\n      zurTafel: false,\r\n      saveActive: false,\r\n      deleteActive: deleteActive,\r\n      endeActive: false,\r\n      admin: false,\r\n      dateIsToday: dateIsToday,\r\n      overbooked: false,\r\n      jugend: false,\r\n      nichtVollBerechtigte: false,\r\n      timetable: [],\r\n      isLoading1: true,\r\n      isLoading2: true,\r\n      courtBelegt: [],\r\n    };\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Alle Spieler für die Select-Auswahl laden    \r\n    let url = Config.protokoll + Config.hostname + \"/intern/api/spieler.php\";\r\n    this.setState({ isLoading1: true });\r\n    fetch(url, { credentials: 'same-origin' })\r\n      .then(result => {\r\n        if (result.ok) {\r\n          // console.log(result);\r\n          return result.json();\r\n        } else {\r\n          throw new Error('Fehler beim Laden der Spielerdaten');\r\n        }\r\n      })\r\n      .then(result => {\r\n        let spieler = result.records;\r\n        // console.log(spieler);\r\n        this.setState({ spieler: spieler, isLoading1: false })\r\n      })\r\n      .catch(error => this.setState({ error, isLoading1: false }));\r\n\r\n    // Alle Belegungen des Tages für die Belegungsprüfung laden\r\n    url = Config.protokoll + Config.hostname + \"/intern/api/belegungenabjetzt.php\";\r\n    this.setState({ isLoading2: true });\r\n    fetch(url, { credentials: 'same-origin' })\r\n      .then(result => {\r\n        if (result.ok) {\r\n          // console.log(result);\r\n          return result.json();\r\n        } else {\r\n          throw new Error('Fehler beim Laden der Belegungsdaten');\r\n        }\r\n      })\r\n      .then(result => {\r\n        // console.log(result.records)\r\n        // this.setState({ timetable: getBookableTimes(getTimetable(result.records)), isLoading2: false }); \r\n        this.setState({ timetable: getTimetable(result.records), isLoading2: false });\r\n\r\n      })\r\n      .catch(error => this.setState({ error, isLoading2: false }));\r\n\r\n  }\r\n\r\n  render() {\r\n    const { isLoading1, isLoading2 } = this.state;\r\n    if (isLoading1 || isLoading2) {\r\n      return <p>Loading...</p>\r\n    }\r\n    if (this.state.zurTafel === true) { \r\n      // eslint-disable-next-line\r\n      return <Redirect to={{ pathname: \"/intern/tafel/\", state: this.state.startsAtDate }} />\r\n    }\r\n    const condMF = (Permissions.MANNSCHAFTSFUEHRER === (Permissions.MANNSCHAFTSFUEHRER & this.props.permissions))\r\n    return (\r\n      <div>\r\n        <h1>Spieltag: {this.state.spieltag}</h1>\r\n        <form className=\"form-inline\">\r\n          <fieldset className=\"fields\">\r\n            <div><strong>Buchungstyp</strong></div>\r\n            {!this.state.dateIsToday &&\r\n              <div>Einzel-/Doppel-Buchung nur am aktuellen Tag möglich</div>\r\n            }\r\n            <select id=\"bookingType\" className=\"form-control\" onChange={this.handleChange} value={this.state.bookingType}>\r\n              <option disabled={!this.state.dateIsToday} value=\"ts-einzel\">Einzel</option>\r\n              <option disabled={!this.state.dateIsToday} value=\"ts-doppel\">Doppel</option>\r\n              <option value=\"ts-turnier\">Turnier</option>\r\n              <option disabled={!condMF} value=\"ts-veranstaltung\">Veranstaltung</option>\r\n              <option disabled={!condMF} value=\"ts-training\">Training</option>\r\n              <option disabled={!condMF} value=\"ts-punktspiele\">Punktspiele</option>\r\n            </select>\r\n            <div><strong>Start</strong> <span id=\"startsAtMsg\" className={this.state.startsAtMsgClass}>{this.state.startsAtMsgTxt}</span></div>\r\n            <div className=\"form-group\">\r\n              <div>\r\n                <select id=\"startsAt\" className={'form-control ' + this.state.startsAtMsgClass} onChange={this.handleChange} value={this.state.startsAt}>\r\n                  {\r\n                    Object.keys(this.state.timetable).map(ttl => {\r\n\r\n                      return (\r\n                        <option key={ttl} value={ttl}>\r\n                          {ttl}h\r\n                          {/*\r\n                          &nbsp; {this.state.timetable[ttl][0]} \r\n                          &nbsp; {this.state.timetable[ttl][1]} \r\n                          &nbsp; {this.state.timetable[ttl][2]} \r\n                          &nbsp; {this.state.timetable[ttl][3]} \r\n                          &nbsp; {this.state.timetable[ttl][4]} \r\n                          &nbsp; {this.state.timetable[ttl][5]}\r\n                      */}\r\n                        </option>\r\n                      )\r\n                    })\r\n                  }\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div><strong>Platz</strong></div>\r\n            <div className=\"form-group\">\r\n              <select id=\"court\" className=\"form-control\" onChange={this.handleChange} value={this.state.court}>\r\n                <option value=\"--\">--</option>\r\n                <option disabled={this.state.courtBelegt[0]} value=\"1\">1</option>\r\n                <option disabled={this.state.courtBelegt[1]} value=\"2\">2</option>\r\n                <option disabled={this.state.courtBelegt[2]} value=\"3\">3</option>\r\n                <option disabled={this.state.courtBelegt[3]} value=\"4\">4</option>\r\n                <option disabled={this.state.courtBelegt[4]} value=\"5\">5</option>\r\n                <option disabled={this.state.courtBelegt[5]} value=\"6\">6</option>\r\n              </select>\r\n            </div>\r\n            <div><strong>Ende</strong></div>\r\n            <div className=\"form-group\">\r\n              <div>\r\n                <select id=\"endsAt\" className={'form-control ' + this.state.startsAtMsgClass} onChange={this.handleChange} value={this.state.endsAt}>\r\n                  {\r\n                    Object.keys(this.state.timetable).map(ttl => {\r\n                      return (\r\n                        // <option disabled={!this.state.endeActive} key={ttl} value={ttl}>\r\n                        <option key={ttl} value={ttl}>\r\n                          {ttl}h\r\n                          {/* &nbsp; {this.state.timetable[ttl][0]} \r\n                          &nbsp; {this.state.timetable[ttl][1]} \r\n                          &nbsp; {this.state.timetable[ttl][2]} \r\n                          &nbsp; {this.state.timetable[ttl][3]} \r\n                          &nbsp; {this.state.timetable[ttl][4]} \r\n                          &nbsp; {this.state.timetable[ttl][5]} */}\r\n                        </option>\r\n                      )\r\n                    })\r\n                  }\r\n                </select>\r\n              </div>\r\n\r\n            </div>\r\n            <div><strong>{(this.state.bookingType.match(/(ts-einzel)|(ts-doppel)|(ts-turnier)/ig)) ? 'Spieler' : 'Verantwortlicher'}</strong> <span id=\"p1Msg\" className={this.state.p1MsgClass}>{this.state.p1MsgTxt}</span></div>\r\n            <div className=\"form-row\">\r\n              <select id=\"p1\" className={'form-control ' + this.state.p1MsgFormCtrl} onChange={this.handleChange} value={this.state.p1}>\r\n                <option value=\"0\">- Bitte auswählen -</option>\r\n                {this.state.spieler.map(r => {\r\n                  return (\r\n                    <option key={'p1' + r.id} value={r.id}>{r.spieler + spielerzusatz(r.geburtsdatum, r.schnupper)}</option>\r\n                  )\r\n                })}\r\n              </select>\r\n              {(this.state.bookingType.match(/(ts-einzel)|(ts-turnier)|(ts-doppel)/ig)) ?\r\n                <select id=\"p2\" className={'form-control ' + this.state.p1MsgFormCtrl} onChange={this.handleChange} value={this.state.p2}>\r\n                  <option value=\"0\">- Bitte auswählen -</option>\r\n                  {this.state.spieler.map(r => {\r\n                    return (\r\n                      <option key={'p2' + r.id} value={r.id}>{r.spieler + spielerzusatz(r.geburtsdatum, r.schnupper)}</option>\r\n                    )\r\n                  })}\r\n                </select>\r\n                : ''\r\n              }\r\n            </div>\r\n            <div className=\"form-row\">\r\n              {(this.state.bookingType === \"ts-doppel\") ?\r\n                <select id=\"p3\" className={'form-control ' + this.state.p1MsgFormCtrl} onChange={this.handleChange} value={this.state.p3}>\r\n                  <option value=\"0\">- Bitte auswählen -</option>\r\n                  {this.state.spieler.map(r => {\r\n                    return (\r\n                      <option key={'p3' + r.id} value={r.id}>{r.spieler + spielerzusatz(r.geburtsdatum, r.schnupper)}</option>\r\n                    )\r\n                  })}\r\n                </select>\r\n                : ''\r\n              }\r\n              {(this.state.bookingType === \"ts-doppel\") ?\r\n                <select id=\"p4\" className={'form-control ' + this.state.p1MsgFormCtrl} onChange={this.handleChange} value={this.state.p4}>\r\n                  <option value=\"0\">- Bitte auswählen -</option>\r\n                  {this.state.spieler.map(r => {\r\n                    return (\r\n                      <option key={'p4' + r.id} value={r.id}>{r.spieler + spielerzusatz(r.geburtsdatum, r.schnupper)}</option>\r\n                    )\r\n                  })}\r\n                </select>\r\n                : ''\r\n              }\r\n            </div>\r\n\r\n            <div><strong>Bemerkung</strong> <span id=\"commentMsg\" className={this.state.commentMsgClass}>{this.state.commentMsgTxt}</span></div>\r\n            <div className=\"form-group\">\r\n              <input type=\"text\" id=\"comment\" className={'form-control w-100 ' + this.state.p1MsgFormCtrl} onChange={this.handleChange} value={this.state.comment} placeholder=\"Spielergebnis, Gastname, ...\" />\r\n            </div>\r\n\r\n            <button type=\"submit\" onClick={e => { this.handleSave(e) }} className=\"btn btn-primary m-1\" disabled={!this.state.saveActive}>Speichern</button>\r\n            <button type=\"submit\" onClick={e => { this.handleDelete(e) }} className=\"btn btn-primary m-2\" disabled={!this.state.deleteActive}>Löschen</button>\r\n          </fieldset>\r\n        </form>\r\n      </div >\r\n    )\r\n  }\r\n\r\n  handleSave(e) {\r\n    e.preventDefault();\r\n    // console.log(\"SAVE FORM DATA NOW!\");\r\n    const s = {}\r\n    // Meldungen zurücksetzen\r\n    s.startsAtMsgTxt = ''\r\n    s.startsAtMsgClass = ''\r\n    s.saveActive = true\r\n    s.p1MsgFormCtrl = ''\r\n\r\n    let parameters =\r\n      '?op=cu'\r\n      + '&rid=' + this.state.r.id\r\n      + '&ds=' + this.state.startsAtDate + ' ' + this.state.startsAt\r\n      + '&de=' + this.state.endsAtDate + ' ' + this.state.endsAt\r\n      + '&uid=' + this.props.userId\r\n      + '&p1=' + this.state.p1\r\n      + '&p2=' + this.state.p2\r\n      + '&p3=' + this.state.p3\r\n      + '&p4=' + this.state.p4\r\n      + '&c=' + this.state.court\r\n      + '&t=' + this.state.bookingType\r\n      + '&cmt=' + this.state.comment\r\n      + '&pr=0'\r\n      ;\r\n    let url = Config.protokoll + Config.hostname\r\n      + '/intern/api/platz.php'\r\n      + parameters;\r\n    // console.log(url);\r\n    fetch(url, { credentials: 'same-origin' })\r\n      .then(result => {\r\n        if (result.ok) {\r\n          return result.json()\r\n        } else {\r\n          throw new Error('Fehler beim Erzeugen/Updaten der Belegung' + this.state.r.id);\r\n        }\r\n      })\r\n      .then(result => {\r\n        let rc = result.records[0].returncode;\r\n        if (rc === 'ok') {\r\n          // Logging der Buchung\r\n          let logurl =\r\n            Config.protokoll\r\n            + Config.hostname\r\n            + Config.buchungenlog\r\n            + parameters;\r\n          fetch(logurl, { credentials: 'same-origin' }); // Wenn Logging fehlschlagen sollte, dann verzichten wir eben darauf\r\n          this.setState({ zurTafel: true })\r\n        } else if (rc === 'bereits belegt') {\r\n          // Fehlermeldung\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.platzbelegt;\r\n        } else {\r\n          // User nicht authentifiziert oder etwas stimmt generell nicht\r\n          window.location.href = Config.loginPage\r\n        }\r\n        // Alle Ergebnisse in den State\r\n        this.setState(s)\r\n      })\r\n  }\r\n\r\n  handleDelete(e) {\r\n\r\n    const sdStr = this.state.startsAtDate + 'T' + this.state.startsAt + \"Z\";\r\n    const sd = new Date(sdStr);\r\n    const jetzt = new Date();\r\n\r\n    e.preventDefault();\r\n\r\n    if (sd >= jetzt || (Permissions.VORSTAND & this.props.permissions)) {\r\n      let parameters =\r\n        '?op=d'\r\n        + '&rid=' + this.state.r.id\r\n        + '&uid=' + this.props.userId;\r\n      let url =\r\n        Config.protokoll\r\n        + Config.hostname\r\n        + Config.platzbuchungen\r\n        + parameters;\r\n      fetch(url, { credentials: 'same-origin' })\r\n        .then(result => {\r\n          if (result.ok) {\r\n            // Logging der Buchung\r\n            let logurl = Config.protokoll + Config.hostname\r\n              + Config.buchungenlog\r\n              + parameters;\r\n            fetch(logurl, { credentials: 'same-origin' });\r\n            this.setState({ zurTafel: true });\r\n          }\r\n        })\r\n    } else {\r\n      this.setState({ zurTafel: true });\r\n    }\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handleChange(e) {\r\n    e.preventDefault();\r\n\r\n    this.setState({ [e.target.id]: e.target.value }, () => {\r\n      const s = {}\r\n\r\n      // Meldungen zurücksetzen\r\n      s.p1MsgTxt = ''\r\n      s.p1MsgClass = ''\r\n      s.startsAtMsgTxt = ''\r\n      s.startsAtMsgClass = ''\r\n      s.commentMsgTxt = ''\r\n      s.commentMsgClass = ''\r\n\r\n      s.saveActive = true\r\n      s.deleteActive = true\r\n      s.endeActive = false\r\n      s.p1MsgFormCtrl = ''\r\n      s.overbooked = false\r\n      s.startsAt = this.state.startsAt\r\n\r\n      // Alle nicht buchbaren Zeiten der Timetable deaktivieren\r\n      // s.timetable = getBookableTimes(this.state.timetable)\r\n      s.timetable = this.state.timetable\r\n      // Belegte Plätze im Select disablen\r\n      s.courtBelegt = s.timetable[s.startsAt].map(c => c === Config.platzBelegt)\r\n\r\n      // Endezeit errechnen\r\n      let endsAtViertel = this.state.startsAt.substring(3, 5)\r\n      let endsAtStd = this.state.endsAt.substring(0, 2)\r\n      if (this.state.bookingType === \"ts-einzel\") {\r\n        endsAtStd = (Number(this.state.startsAt.substring(0, 2)) + 1).toLocaleString('de-DE', { minimumIntegerDigits: 2, useGrouping: false })\r\n      }\r\n      else if (this.state.bookingType.match(/(ts-doppel)/ig)) {\r\n        endsAtStd = (Number(this.state.startsAt.substring(0, 2)) + 2).toLocaleString('de-DE', { minimumIntegerDigits: 2, useGrouping: false })\r\n      }\r\n      else if (this.state.bookingType.match(/(ts-turnier)/ig)) {\r\n        if (!(Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))) {\r\n          endsAtStd = (Number(this.state.startsAt.substring(0, 2)) + 2).toLocaleString('de-DE', { minimumIntegerDigits: 2, useGrouping: false })\r\n        } else {\r\n          endsAtViertel = this.state.endsAt.substring(3, 5)\r\n        }\r\n      }\r\n      s.endsAt = endsAtStd + \":\" + endsAtViertel\r\n\r\n      // Bedingungen\r\n      let condEinGast = false\r\n      let condEinMitglied = false\r\n      let condEinSpielerErwVoll = false\r\n      let condDoppelteSpieler = false\r\n      let condUserIstSpieler = false\r\n\r\n      const datestring = this.state.startsAtDate + 'T' + this.state.startsAt + \"Z\"\r\n      const sd = new Date(datestring)\r\n      const hd = new Holidays()\r\n      hd.init('DE', 'BY')\r\n      const condFeiertag = hd.isHoliday(sd) ? true : false\r\n      const condSonnOderFeiertag = (condFeiertag || (sd.getDay() === 0) || (sd.getDay() === 6))\r\n      // const condPlatz6 = (Number(this.state.court) === 6)\r\n\r\n      // Validierung\r\n      // -----------\r\n      // Es wird validiert, ob Erwachsene, Schnuppermitglieder und Jugendliche \r\n      // wirklich spielberechtigt sind und ob die eingetragenen Zeiten stimmen\r\n\r\n      // Buchungszeiten in Minuten\r\n      const start = Number(s.startsAt.substring(0, 2)) * 60 + Number(s.startsAt.substring(3, 5))\r\n      let ende = Number(s.endsAt.substring(0, 2)) * 60 + Number(s.endsAt.substring(3, 5))\r\n\r\n      const pKeys = [Number(this.state.p1), Number(this.state.p2), Number(this.state.p3), Number(this.state.p4)]\r\n\r\n      // Haben wir einen GAST oder ein Mitglied ohne Namen?\r\n      // Ist der aktuelle User auch Spieler?\r\n      // Ist ein erwachsenes Vollmitglied dabei?\r\n\r\n      const spieler = this.state.spieler;\r\n      condEinSpielerErwVoll = false\r\n      pKeys.forEach((p) => {\r\n        // eslint-disable-next-line\r\n        if (p != null && p != 0) // \r\n        {\r\n          if (p === Number(this.props.userId)) {\r\n            condUserIstSpieler = true\r\n          } if (p === Config.gastId || p === Config.gastJugId) {\r\n            condEinGast = true\r\n          } if (p === Config.mitgliedId) {\r\n            condEinMitglied = true\r\n          }\r\n          // Geburtsdatum und Schnupperstatus prüfen wir mittels spieler-SELECT-Array\r\n          let pAttr = spieler.find(o => o.id === p.toString())\r\n          if (!(isJugendlicher(pAttr['geburtsdatum']) || pAttr['schnupper'] === \"1\")) {\r\n            condEinSpielerErwVoll = true\r\n          }\r\n        }\r\n      })\r\n      // Auch der Ersteller der Buchung ist zu allem berechtigt\r\n      condUserIstSpieler = condUserIstSpieler || this.props.userId === this.state.r.user_id\r\n\r\n      let saveActiveMerker = true\r\n      // Message an der Spielzeit\r\n      // Formal müssen Spieler korrekt eingetragen sein\r\n      if (this.state.bookingType.match(/(ts-veranstaltung)|(ts-training)|(ts-nichtreservierbar)/ig)) {\r\n        // Ein Spieler muss eingetragen werden\r\n        if (Number(this.state.p1) === 0) {\r\n          [s.p1msgClass, s.saveActive, s.p1MsgTxt] = Messages.spieleranzahl\r\n          s.p1MsgFormCtrl = 'is-invalid'\r\n        }\r\n        // Spieler 2 bis 4 werden \"gelöscht\"\r\n        s.p2 = s.p3 = s.p4 = 0\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      if (this.state.bookingType.match(/(ts-turnier)|(ts-einzel)/ig)) {\r\n        // Zwei Spieler müssen eingetragen werden, beide nicht 0 und unterschiedlich\r\n        if (Number(this.state.p1) === 0 || Number(this.state.p2) === 0) {\r\n          [s.p1msgClass, s.saveActive, s.p1MsgTxt] = Messages.spieleranzahl;\r\n          s.p1MsgFormCtrl = 'is-invalid'\r\n        } else if (Number(this.state.p1) === Number(this.state.p2)) {\r\n          // Sind die Spieler doppelt?\r\n          condDoppelteSpieler = true;\r\n          [s.p1msgClass, s.saveActive, s.p1MsgTxt] = Messages.spieleranzahl;\r\n          s.p1MsgFormCtrl = 'is-invalid'\r\n        }\r\n        // Spieler 3 bis 4 werden \"gelöscht\"\r\n        s.p3 = s.p4 = 0\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      if (this.state.bookingType === \"ts-doppel\") {\r\n        // Vier Spieler\r\n        // Sind unter 4 Spielern welche doppelt?\r\n        condDoppelteSpieler = (_.uniq([this.state.p1, this.state.p2, this.state.p3, this.state.p4]).length < 4)\r\n\r\n        if (!condEinGast) {\r\n          if (condDoppelteSpieler || (Number(this.state.p3) === 0 || Number(this.state.p4) === 0)) {\r\n            [s.p1MsgClass, s.saveActive, s.p1MsgTxt] = Messages.spieleranzahl;\r\n            s.p1MsgFormCtrl = 'is-invalid'\r\n          }\r\n        }\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      if (condEinGast || condEinMitglied) {\r\n        if (this.state.bookingType.match(/(ts-einzel)|(ts-doppel)/ig)) {\r\n          // Gäste und unbenannte Mitglieder müssen einen Kommentar/Namen vermerken. Mind. 2 Zeichen\r\n          if (this.state.comment.length < 2) {\r\n            [s.commentMsgClass, s.saveActive, s.commentMsgTxt] = condEinGast ? Messages.gast : Messages.mitglied\r\n            s.p1MsgFormCtrl = 'is-invalid'\r\n          }\r\n        }\r\n        else {\r\n          [s.p1MsgClass, s.saveActive, s.p1MsgTxt] = Messages.spieleranzahl;\r\n          s.p1MsgFormCtrl = 'is-invalid'\r\n        }\r\n      }\r\n      if (this.state.bookingType === \"ts-veranstaltung\") {\r\n        [s.commentMsgClass, s.saveActive, s.commentMsgTxt] = Messages.veranstaltung\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      if (this.state.bookingType.match(/(ts-einzel)|(ts-doppel)/ig)) {\r\n        // Jetzt die Berechtigungen nach Alter, Status, Zeitpunkt. Message an der Spielzeit\r\n        // Diese Bedingungen sind von der Entscheidungstabelle (Dokumentation, Excel) abgeleitet\r\n        const dToday = new Date()\r\n\r\n        const dH = dToday.getHours()\r\n        const dM = dToday.getMinutes()\r\n        const minutesToday = (dH * 60 + dM)\r\n        if ((start - minutesToday) > Config.maxMinutesDistance && !condEinSpielerErwVoll && !condSonnOderFeiertag && ende > (Config.eveningTime / 100 * 60)) {\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.erwachsenenvorrecht;\r\n          s.overbooked = true\r\n        }\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      // Auswertung Spielzeit formal, Message an der Spielzeit\r\n      if (start >= ende) {\r\n        [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.zeit;\r\n      }\r\n      else if (this.state.bookingType === \"ts-einzel\") {\r\n        if ((ende - start) > Config.singleTime) {\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.einzeldauer;\r\n        }\r\n      }\r\n      else if (this.state.bookingType === \"ts-doppel\") {\r\n        if ((ende - start) > Config.doubleTime) {\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.doppeldauer;\r\n        }\r\n      }\r\n      else if (this.state.bookingType === \"ts-turnier\") {\r\n        if ((ende - start) !== Config.turnierTime && (Permissions.VORSTAND !== (Permissions.VORSTAND & this.props.permissions))) {\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.turnierspieldauer;\r\n        } else {\r\n          [s.startsAtMsgClass, s.saveActive, s.startsAtMsgTxt] = Messages.turnier;\r\n        }\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      // Berechtigung zum Speichern und Löschen und flexible Endezeit\r\n      if (this.state.bookingType.match(/(ts-turnier)/ig)) {\r\n        s.saveActive = (Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))\r\n        s.deleteActive = (Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))\r\n        s.endeActive = false\r\n      }\r\n      if (this.state.bookingType.match(/(ts-einzel)|(ts-doppel)/ig)) {\r\n        s.saveActive = condUserIstSpieler || (Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))\r\n        s.deleteActive = condUserIstSpieler || (Permissions.VORSTAND === (Permissions.VORSTAND & this.props.permissions))\r\n        s.endeActive = false\r\n      }\r\n      if (this.state.bookingType.match(/(ts-training)|(ts-punktspiele)|(ts-nichtreservierbar)|(ts-veranstaltung)/ig)) {\r\n        s.saveActive = (Permissions.MANNSCHAFTSFUEHRER === (Permissions.MANNSCHAFTSFUEHRER & this.props.permissions))\r\n        s.endeActive = true\r\n      }\r\n      if (this.state.bookingType.match(/(ts-training)|(ts-punktspiele)|(ts-nichtreservierbar)|(ts-veranstaltung)/ig)) {\r\n        s.deleteActive = (Permissions.MANNSCHAFTSFUEHRER === (Permissions.MANNSCHAFTSFUEHRER & this.props.permissions))\r\n      }\r\n      saveActiveMerker = (saveActiveMerker === true) ? s.saveActive : false\r\n\r\n      s.saveActive = saveActiveMerker\r\n\r\n      // Alle Ergebnisse in den State\r\n      this.setState(s)\r\n\r\n    });\r\n  }\r\n}\r\n\r\nexport default BelForm;\r\n\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport BelForm from './BelForm';\r\nimport { Link } from 'react-router-dom';\r\nimport Config from './Defaults';\r\n\r\nclass Belegung extends Component {\r\n  \r\n  constructor(props) {\r\n    super(props);\r\n    \r\n    this.state = { \r\n      belegung : [],\r\n      isLoading : false,\r\n      error : false,\r\n    };\r\n  }  \r\n  componentWillMount() {\r\n    const {op} = this.props.location.state;\r\n    if (op === \"update\") {\r\n      const {i, d} = this.props.location.state;\r\n      this.updateBel(i, d);\r\n    } else if (op === \"new\") {\r\n      const {c, d} = this.props.location.state;\r\n      this.newBel(c, d);\r\n    }\r\n  }\r\n  \r\n  updateBel(id, day) {\r\n    const url = Config.protokoll + Config.hostname + \"/intern/api/platz.php?op=r&rid=\" + id;\r\n  \r\n    this.setState({isLoading : true});\r\n    \r\n    fetch(url, {credentials: 'same-origin'})\r\n    .then(result => {\r\n      if (result.ok) {\r\n        if (result.redirected) {\r\n          console.log(\"BelDetails.js/Checkuser: Authentifizierungsfehler\")\r\n          window.location.href = result.url\r\n        }\r\n        return result.json();\r\n      } else {\r\n        throw new Error('Fehler beim Laden der Platzbuchungsdetails');\r\n      }\r\n    })\r\n    .then(result => {\r\n      let belegung = result.records.map( r => {\r\n        return (\r\n          <div key={r.id} className=\"p-2\">\r\n              <Link to={{ pathname: '/intern/tafel/', state: {d: day} }}><p className=\"btn btn-secondary\">Zurück</p></Link>\r\n              <BelForm r={r} userId={this.props.userId} permissions={this.props.permissions} />\r\n          </div>\r\n        )\r\n      })\r\n      this.setState({ belegung: belegung })\r\n    })\r\n    .catch(error => this.setState({ error, isLoading: false }));\r\n  }\r\n  \r\n  newBel(court, day)\r\n  {\r\n    let r = getEmptyBel(court, day);\r\n    let belegung = [\r\n        <div key={-1} className=\"p-2\">\r\n            <Link to={{ pathname: '/intern/tafel/', state: {d: day} }}><p className=\"btn btn-secondary\">Zurück</p></Link>\r\n            <BelForm r={r} userId={this.props.userId} permissions={this.props.permissions} />\r\n        </div>\r\n    ];\r\n    this.setState({ belegung: belegung })\r\n  }\r\n  \r\n  render() {\r\n    return (\r\n      <div>{this.state.belegung}</div>\r\n    );\r\n  }\r\n}\r\n\r\nfunction getEmptyBel(court, day) {\r\n  return {\r\n    id: 0,\r\n    user_id: 0,\r\n    p1: '',\r\n    p2: '',\r\n    p3: '',\r\n    p4: '',\r\n    court: court,\r\n    starts_at: day + ' 08:00:00',\r\n    ends_at: day + ' 09:00:00',\r\n    booking_type: '',\r\n    geburtsdatum: '0000-00-00',\r\n    p1id: 0,\r\n    p2id: 0,\r\n    p3id: 0,\r\n    p4id: 0,    \r\n  }\r\n}\r\nexport default Belegung;\r\n  ","import React, { Component } from 'react';\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport Belegungstag from './Belegungstag';\r\nimport Belegung from './Belegung';\r\n\r\n\r\nclass Routing extends Component {\r\n    render() {\r\n      return (\r\n        <Switch>\r\n          <Route exact path='/intern/tafel/belegung' render={(props) => <Belegung {...props} userId={this.props.userId} permissions={this.props.permissions} />} />\r\n          <Route render={(props) => <Belegungstag {...props} userId={this.props.userId} permissions={this.props.permissions} />} />\r\n        </Switch>\r\n      )\r\n    }\r\n}\r\n\r\n\r\nexport default Routing;\r\n  ","import React, { Component } from 'react';\r\nimport Routing from \"./Routing\";\r\nimport Config from \"./Defaults\";\r\n\r\n\r\nclass App extends Component \r\n{\r\n  constructor(props) {\r\n    super(props);\r\n    \r\n    this.state = { \r\n      user: {},\r\n      isLoggedIn: false,\r\n      permissions: 0,\r\n      renderData: [],\r\n      isLoading1: true,\r\n      isLoading2: true,\r\n    };\r\n  }\r\n  \r\n  componentDidMount()\r\n  {\r\n    this.setState(() => ({ isLoading1: true , isLoading2: true}));\r\n    if (Config.prod) \r\n    { \r\n      this.checkUser();\r\n      this.setPermission();\r\n    } \r\n    else \r\n    {\r\n      // In der Testumgebung simulierter User\r\n      this.setState(() => ({user: Config.testuser, permissions: Config.testuser.permissions}));\r\n\r\n      // Re-rendering - sollte nur auf passiv genutzten Geräten (z. B. Monitor an Platz) verwendet werden\r\n      // this.interval = setInterval(()  => this.forceUpdate(), 1000)\r\n    }\r\n  }\r\n\r\n  checkUser() \r\n  {\r\n    const url = Config.protokoll + Config.hostname + \"/intern/api/checkuser.php\";\r\n    fetch(url, {credentials: 'same-origin'})\r\n    .then( (res) => {\r\n      if (res.ok) {\r\n        res.json()\r\n        .then( (user) => {\r\n          if (user.retcode === 'OK') {\r\n            this.setState(() => ({user: user.user, isLoading1: false}));\r\n          } else {\r\n            // console.log(\"App.js/Checkuser: Authentifizierungsfehler\")\r\n            window.location.href = Config.protokoll + Config.hostname + Config.loginPage;\r\n          }\r\n        });\r\n      }\r\n    })\r\n  }\r\n  \r\n  setPermission() \r\n  {\r\n    const url = Config.protokoll + Config.hostname + \"/intern/api/checkpermission.php\";\r\n    // console.log(url)\r\n    fetch(url, {credentials: 'same-origin'})\r\n    .then( (res) => {\r\n      if (res.ok) {\r\n        res.json()\r\n        .then( (permissions) => {\r\n          // console.log(permitted.retcode)\r\n          this.setState(() => ({permissions: permissions.retcode, isLoading2: false}))\r\n        })\r\n      }\r\n    })\r\n  }\r\n  \r\n  render() \r\n  {\r\n    const { isLoading1, isLoading2 } = this.state;\r\n    if (Config.prod && (isLoading1 || isLoading2)) {\r\n      return <p>Loading...</p>\r\n    } else {\r\n      return (\r\n        <React.Fragment>\r\n          <div className=\"container\">\r\n            <div className=\"row\">\r\n              <div className=\"col text-left\">\r\n                <img src=\"/images/tcoplain_0,1x.png\" alt=\"TCO -Logo\" />\r\n              </div>\r\n              <div className=\"col\">\r\n                <span className=\"h6 text-center ml-2\"><a href=\"/intern/tafel/\" id=\"appname\">Platzbuchung</a></span> \r\n                <span className=\"text-center ml-2\"><small> ({this.state.user.vorname + ' ' + this.state.user.nachname})</small></span>\r\n              </div>\r\n              <div className=\"col\">\r\n                <div className=\"small align-bottom\"><span className=\"pl-5\"><a href=\"/intern/logout.php\"><img src=\"/images/logout.png\" alt=\"Logout\" /></a></span></div> \r\n              </div>\r\n            </div>\r\n          </div>\r\n              \r\n          <Routing userId = {this.state.user.id} permissions = {this.state.permissions}/>\r\n          <footer className=\"blockquote-footer\">(c) 2019 by Conny Roloff. Dem TC Olching zur kostenlosen Nutzung zur Verfügung gestellt.</footer>\r\n        </React.Fragment>\r\n      )}\r\n    }\r\n  }\r\n\r\n\r\nexport default App;\r\n  ","import 'babel-polyfill'; \r\nimport 'react-app-polyfill/ie11';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport App from './components/App';\r\n\r\nReactDOM.render((\r\n  <Router>\r\n    <App />\r\n  </Router>\r\n), document.getElementById('root'));\r\n\r\n// import index from \"./js/index\";\r\n"],"sourceRoot":""}